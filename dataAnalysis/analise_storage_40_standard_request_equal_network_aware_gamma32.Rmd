---
title: "Gamma 32 Storage Standard"
author: "Marisangila Alves"
date: "6/15/2022"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr)
library(ggplot2)
library(plyr)
library(ggpubr)
library(cowplot)
library(TTR)
library(outliers)
library(stringr)
```

```{r config, echo=FALSE, warning=FALSE, results=FALSE, message=FALSE}
source("../library_network_load.r")
source("../hops.r")

fit_sd <- function(thp_cur)
{
for (i in 1:n){
  if(thp_cur[[1]][i] == 0 || thp_cur[[1]][i] < 0  || is.na(thp_cur[[1]][i]) )
  {
    thp_cur[[2]][i] = 0
    thp_cur[[2]][i] = 0
    thp_cur[[3]][i] = 0
  }
  if (is.na(thp_cur[[2]][i]) || is.na(thp_cur[[3]][i])){
    thp_cur[[2]][i] = 0
    thp_cur[[3]][i] = 0
  }
  if( thp_cur[[2]][i] < 0 || thp_cur[[3]][i] < 0){
    thp_cur[[2]][i] = 0
    thp_cur[[3]][i] = 0
  }
}
  return(thp_cur)
}
```

```{r echo=FALSE, warning=FALSE, results=FALSE, message=FALSE}
# storage 0.2
paths02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Requests', col_names=TRUE))
rate_admission02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless02 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc02 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc02 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson02 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Poisson', col_names=TRUE))
zipf02 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Zipf', col_names=TRUE))
#times02 <- read.table("/dataAnalysisdata/storage/instance_x_storage_0.2.dat", header = TRUE)
delay02 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Delay', col_names=TRUE))
rtt02 =  data.frame(read_excel("data/instance_gama32.xlsx", sheet='RTT', col_names=TRUE))
# storage 0.4
paths04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Requests', col_names=TRUE))
rate_admission04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless04 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc04 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc04 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson04 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Poisson', col_names=TRUE))
zipf04 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Zipf', col_names=TRUE))
#times04 <- read.table("/dataAnalysisdata/storage/instance_x_storage_0.4.dat", header = TRUE)
delay04 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Delay', col_names=TRUE))
rtt04 =  data.frame(read_excel("data/instance_gama32.xlsx", sheet='RTT', col_names=TRUE))

# storage 0.6
paths06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Requests', col_names=TRUE))
rate_admission06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless06 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc06 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc06 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson06 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Poisson', col_names=TRUE))
zipf06 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Zipf', col_names=TRUE))
#times06 <- read.table("/dataAnalysisdata/storage/instance_x_storage_0.4.xlsx", header = TRUE)
delay06 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Delay', col_names=TRUE))
rtt06 =  data.frame(read_excel("data/instance_gama32.xlsx", sheet='RTT', col_names=TRUE))

# storage 0.8
paths08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Requests', col_names=TRUE))
rate_admission08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless08 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc08 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc08 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson08 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Poisson', col_names=TRUE))
zipf08 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Zipf', col_names=TRUE))
#times08 <- read.table("data/instance_gama32.xlsx", header = TRUE)
delay08 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Delay', col_names=TRUE))
rtt08 =  data.frame(read_excel("data/instance_gama32.xlsx", sheet='RTT', col_names=TRUE))

# storage 1.0
paths1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Requests', col_names=TRUE))
rate_admission1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless1 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc1 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc1 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson1 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Poisson', col_names=TRUE))
zipf1 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Zipf', col_names=TRUE))
#times1 <- read.table("data/instance_gama32.xlsx", header = TRUE)
delay1 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Delay', col_names=TRUE))

# storage 1.2
paths12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Requests', col_names=TRUE))
rate_admission12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless12 <- data.frame(read_excel("data/instance_gama32.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc12 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc12 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson12 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Poisson', col_names=TRUE))
zipf12 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Zipf', col_names=TRUE))
#times12 <- read.table("data/instance_gama32.xlsx", header = TRUE)
delay12 = data.frame(read_excel("data/instance_gama32.xlsx", sheet='Delay', col_names=TRUE))
```

```{r echo=FALSE, warning=FALSE, results=FALSE, message=FALSE}
save = FALSE
save_pt = TRUE

#count hops without content: n-2 
HOPS <- 2
BUFFER <- 48 

NUM_SBS_BY_MBS = 15
NUM_MBS = 2

zipf = 0.8
lambda <- 5
n <- 100
beta <- 0.2
mobility <- 10
storage <- c(0.2,0.4,0.6,0.8)

bs <- unique(server_use04$BS)


qos <- c(100)
#second to millisecond
delay02$Delay <- delay02$Delay * 1000
delay04$Delay <- delay04$Delay * 1000
delay06$Delay <- delay06$Delay * 1000
delay08$Delay <- delay08$Delay * 1000
delay1$Delay <- delay1$Delay * 1000
delay12$Delay <- delay12$Delay * 1000
```

### Parâmetros

    Parâmetros      | Valores
    ----------------------|----------
    alfa zipf             | `r zipf` 
    lambda                | `r lambda`
    n                     | `r n`
    beta                  | `r beta`
    BS                    | `r length(bs)-1`
    Cache                 | 100
    UE                    | 200
    Storage               | MBS: 10/20/30/40/50/60GB - SBS: 4/6/8/10/12GB
    Coverage              | MBS 300 SBS 70
    RTT inicial           | CS/MBS 0.001s(1ms) MBS/MBS 0.001s(1ms) MBS/SBS 0.001s(1ms) SBS/UE 0.001s(1ms)
    Tempo da Requisição   | 10 eventos
    Mobilidade            | `r mobility`m


### Informações da Aplicação.

    Vazão Mínima |     Tamanho da Cache        | Buffer |
    -------------|-----------------------------|--------|
     `r qos` Mbps |      2GB/2000MB             |  48Mb  |
     `r qos` Mbps |      4GB/4000MB             |  48Mb  |
     `r qos` Mbps |      8GB/8000MB             |  48Mb  |



### Distribuição das Requisições.

```{r echo=FALSE, warning=FALSE, results=FALSE, message=FALSE}
old.par <- par(mfrow=c(1, 2))
hist(poisson1$Qtd_Requests, freq=F, col=c("#CCE5FF"))
lines(density(poisson1$Qtd_Requests))
par(old.par)
```

### Distribuição de popularidade do conteúdo solicitado.

```{r echo=FALSE, message=FALSE, results=TRUE, warning=FALSE}
zipf08 <- count(zipf08, "Caches")
zipf08 <- zipf08[order(zipf08$freq,decreasing = TRUE),]
old.par <- par(mfrow=c(1, 2))
hist(zipf08$freq,breaks = "FD" ,freq=F,col=c("#003366"))
par(old.par)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# acceptance_requests02 <- round(rate_admission02$Rate_Admission,4) * 100
# acceptance_requests04 <- round(rate_admission04$Rate_Admission,4) * 100
# acceptance_requests06 <- round(rate_admission06$Rate_Admission,4) * 100
# acceptance_requests08 <- round(rate_admission08$Rate_Admission,4) * 100
# acceptance_requests1 <- round(rate_admission1$Rate_Admission,4) * 100
# acceptance_requests12 <- round(rate_admission12$Rate_Admission,4) * 100
```

<!-- ### Distribuição da Latência -->

```{r echo=FALSE, results=FALSE, warning=FALSE}
# type_storage <- rep("0.2",length(delay02$Delay))
# d_02 <- data.frame(delay = c(delay02$Delay),
#                    type = type_storage,
#                    stringsAsFactors = FALSE)
# 
# type_storage <- rep("0.4",length(delay04$Delay))
# d_04 <- data.frame(delay = c(delay04$Delay),
#                    type = type_storage,
#                    stringsAsFactors = FALSE)
# type_storage <- rep("0.6",length(delay06$Delay))
# d_06 <- data.frame(delay = c(delay06$Delay),
#                    type = type_storage,
#                    stringsAsFactors = FALSE)
# type_storage <- rep("0.8",length(delay08$Delay))
# d_08 <- data.frame(delay = c(delay08$Delay),
#                    type = type_storage,
#                    stringsAsFactors = FALSE)
# type_storage <- rep("1.0",length(delay1$Delay))
# d_1 <- data.frame(delay = c(delay1$Delay),
#                   type = type_storage,
#                   stringsAsFactors = FALSE)
# 
# type_storage <- rep("1.2",length(delay12$Delay))
# d_12 <- data.frame(delay = c(delay12$Delay),
#                    type = type_storage,
#                    stringsAsFactors = FALSE)
``` 

```{r echo=FALSE, results=FALSE, warning=FALSE}
# df <- rbind(d_02,d_04,d_06,d_08)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# if (save_pt){
#   x.lab <- "Latência Total da Rede"
#   y.lab <- "Frequência"
#   leg <- "Armazenamento"
# }else{
#   x.lab <- "Total Network Delay"
#   y.lab <- "Frequency"
#   leg <- "Storage"
# }
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# ecdf <- ggplot(df,aes(x=delay, colour = type)) + stat_ecdf(geom = "point")+
#   labs(colour = leg)+
#   theme_classic()+  
#   theme(legend.position = "right",
#         #legend.justification = c("right", "top"),
#         #legend.box.background = element_rect(color=NA),
#         #legend.box.just = "right",
#         legend.key = element_rect(colour = NA, fill = NA),
#         #legend.margin = margin(6, 6, 6, 6),
#         legend.title = element_text(face = "bold", size = 10,),
#         legend.text = element_text(size = 10))+ 
#   xlab(x.lab)+
#   ylab(y.lab)+
#   geom_vline(xintercept = 4,linetype = "dotted")+
#   geom_vline(xintercept = 10,linetype = "longdash")
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# print(ecdf)
```

```{r  echo=FALSE, results=FALSE, warning=FALSE}
# minor4_02 <- round(sum(delay02$Delay < 4)/length(delay02$Delay),4)
# minor10_02 <- round(sum(delay02$Delay < 10)/length(delay02$Delay),4)
# 
# minor4_04 <- round(sum(delay04$Delay < 4)/length(delay04$Delay),4)
# minor10_04 <- round(sum(delay04$Delay < 10)/length(delay04$Delay),4)
# 
# minor4_06 <- round(sum(delay06$Delay < 4)/length(delay06$Delay),4)
# minor10_06 <- round(sum(delay06$Delay < 10)/length(delay06$Delay),4)
# 
# minor4_08 <- round(sum(delay08$Delay < 4)/length(delay08$Delay),4)
# minor10_08 <- round(sum(delay08$Delay < 10)/length(delay08$Delay),4)
# 
# minor4_1 <- round(sum(delay06$Delay < 4)/length(delay1$Delay),4)
# minor10_1 <- round(sum(delay06$Delay < 10)/length(delay1$Delay),4)
# 
# minor4_12 <- round(sum(delay12$Delay < 4)/length(delay12$Delay),4)
# minor10_12 <- round(sum(delay12$Delay < 10)/length(delay12$Delay),4)
```

### Cache, Cloud e Storage.

```{r echo=FALSE, results=FALSE, warning=FALSE}
server_use02_ran <- server_use02 %>% filter(server_use02$BS != 'MBS0')
server_use04_ran <- server_use04 %>% filter(server_use04$BS != 'MBS0')
server_use06_ran <- server_use06 %>% filter(server_use06$BS != 'MBS0')
server_use08_ran <- server_use08 %>% filter(server_use08$BS != 'MBS0')
server_use1_ran <- server_use1 %>% filter(server_use1$BS != 'MBS0')
server_use12_ran <- server_use12 %>% filter(server_use12$BS != 'MBS0')

ratio_server_use02 <- NULL
ratio_server_use04 <- NULL
ratio_server_use06 <- NULL
ratio_server_use08 <- NULL
ratio_server_use1 <- NULL
ratio_server_use12 <- NULL

# ratio_server_sd_event02 <- c()
# ratio_server_sd_event04 <- c()
# ratio_server_sd_event06 <- c()
# ratio_server_sd_event08 <- c()
# ratio_server_sd_event1 <- c()
# ratio_server_sd_event12 <- c()

for (i in 1:n){
  server_use_n02 <- server_use02_ran %>% filter(server_use02_ran$Event == i)
  sum_total_storage_n02 <- sum(server_use_n02$Total_Storage)
  sum_total_use_n02 <- sum(server_use_n02$Total_Use)
  ratio_server_use_n02 <- (sum_total_use_n02 / sum_total_storage_n02)
  
  ratio_server_use02 <- append(ratio_server_use02,ratio_server_use_n02)
  
  server_use_n02 <- NULL
  sum_total_storage_n02 <- NULL
  ratio_server_use_n02 <- NULL
}
for (i in 1:n){
  server_use_n04 <- server_use04_ran %>% filter(server_use04_ran$Event == i)
  sum_total_storage_n04 <- sum(server_use_n04$Total_Storage)
  sum_total_use_n04 <- sum(server_use_n04$Total_Use)
  ratio_server_use_n04 <- (sum_total_use_n04 / sum_total_storage_n04)
  
  ratio_server_use04 <- append(ratio_server_use04,ratio_server_use_n04)
  
  server_use_n04 <- NULL
  sum_total_storage_n04 <- NULL
  ratio_server_use_n04 <- NULL
}
for (i in 1:n){
  server_use_n06 <- server_use06_ran %>% filter(server_use06_ran$Event == i)
  sum_total_storage_n06 <- sum(server_use_n06$Total_Storage)
  sum_total_use_n06 <- sum(server_use_n06$Total_Use)
  ratio_server_use_n06 <- (sum_total_use_n06 / sum_total_storage_n06)
  
  ratio_server_use06 <- append(ratio_server_use06,ratio_server_use_n06)
  
  server_use_n06 <- NULL
  sum_total_storage_n06 <- NULL
  ratio_server_use_n06 <- NULL
}
for (i in 1:n){
  server_use_n08 <- server_use08_ran %>% filter(server_use08_ran$Event == i)
  sum_total_storage_n08 <- sum(server_use_n08$Total_Storage)
  sum_total_use_n08 <- sum(server_use_n08$Total_Use)
  ratio_server_use_n08 <- (sum_total_use_n08 / sum_total_storage_n08)
  
  ratio_server_use08 <- append(ratio_server_use08,ratio_server_use_n08)
  
  server_use_n08 <- NULL
  sum_total_storage_n08 <- NULL
  ratio_server_use_n08 <- NULL
}
for (i in 1:n){
  server_use_n1 <- server_use1_ran %>% filter(server_use1_ran$Event == i)
  sum_total_storage_n1 <- sum(server_use_n1$Total_Storage)
  sum_total_use_n1 <- sum(server_use_n1$Total_Use)
  ratio_server_use_n1 <- (sum_total_use_n1 / sum_total_storage_n1)
  
  ratio_server_use1 <- append(ratio_server_use1,ratio_server_use_n1)
  
  server_use_n1 <- NULL
  sum_total_storage_n1 <- NULL
  ratio_server_use_n1 <- NULL
}
for (i in 1:n){
  server_use_n12 <- server_use12_ran %>% filter(server_use12_ran$Event == i)
  sum_total_storage_n12 <- sum(server_use_n12$Total_Storage)
  sum_total_use_n12 <- sum(server_use_n12$Total_Use)
  ratio_server_use_n12 <- (sum_total_use_n12 / sum_total_storage_n12)
  
  ratio_server_use12 <- append(ratio_server_use12,ratio_server_use_n12)
  
  server_use_n12 <- NULL
  sum_total_storage_n12 <- NULL
  ratio_server_use_n12 <- NULL
}
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#Sum by events normalized - Fronthaul

load_links_optic02_ran <- load_links_optic02 %>% filter(load_links_optic02$Link != "('MBS0', 'MBS2')"  & load_links_optic02$Link != "('MBS0', 'MBS1')")
load_links_optic04_ran <- load_links_optic04 %>% filter(load_links_optic04$Link != "('MBS0', 'MBS2')"  & load_links_optic04$Link != "('MBS0', 'MBS1')")
load_links_optic06_ran <- load_links_optic06 %>% filter(load_links_optic06$Link != "('MBS0', 'MBS2')"  & load_links_optic06$Link != "('MBS0', 'MBS1')")
load_links_optic08_ran <- load_links_optic08 %>% filter(load_links_optic08$Link != "('MBS0', 'MBS2')"  & load_links_optic08$Link != "('MBS0', 'MBS1')")
load_links_optic1_ran <- load_links_optic1 %>% filter(load_links_optic1$Link != "('MBS0', 'MBS2')"  & load_links_optic1$Link != "('MBS0', 'MBS1')")
load_links_optic12_ran <- load_links_optic12 %>% filter(load_links_optic12$Link != "('MBS0', 'MBS2')"  & load_links_optic12$Link != "('MBS0', 'MBS1')")

load_link_sd_event02 <- c()
load_link_sd_event04 <- c()
load_link_sd_event06 <- c()
load_link_sd_event08 <- c()
load_link_sd_event1 <- c()
load_link_sd_event12 <- c()

load_links_normal02 <- c()
load_links_normal04 <- c()
load_links_normal06 <- c()
load_links_normal08 <- c()
load_links_normal1 <- c()
load_links_normal12 <- c()

for (i in 1:n){
  
  load_links_n02 <- load_links_optic02_ran %>% filter(load_links_optic02_ran$Event == i)
  load_links_n04 <- load_links_optic04_ran %>% filter(load_links_optic04_ran$Event == i)
  load_links_n06 <- load_links_optic06_ran %>% filter(load_links_optic06_ran$Event == i)
  load_links_n08 <- load_links_optic08_ran %>% filter(load_links_optic08_ran$Event == i)
  load_links_n1 <- load_links_optic1_ran %>% filter(load_links_optic1_ran$Event == i)
  load_links_n12 <- load_links_optic12_ran %>% filter(load_links_optic12_ran$Event == i)
  
  sum02 <- sum(load_links_n02$Total_Load) 
  sum04 <- sum(load_links_n04$Total_Load) 
  sum06 <- sum(load_links_n06$Total_Load)
  sum08 <- sum(load_links_n08$Total_Load)
  sum1 <- sum(load_links_n1$Total_Load)
  sum12 <- sum(load_links_n12$Total_Load)
  
  load_link_sd_event02 <- append(load_link_sd_event02, sd(load_links_n02$Total_Load)) 
  load_link_sd_event04 <- append(load_link_sd_event04, sd(load_links_n04$Total_Load)) 
  load_link_sd_event06 <- append(load_link_sd_event06, sd(load_links_n06$Total_Load))
  load_link_sd_event08 <- append(load_link_sd_event08, sd(load_links_n08$Total_Load))
  load_link_sd_event1 <- append(load_link_sd_event1, sd(load_links_n1$Total_Load))
  load_link_sd_event12 <- append(load_link_sd_event12, sd(load_links_n12$Total_Load))
  
  load_links_normal02 = append(load_links_normal02,sum02)
  load_links_normal04 = append(load_links_normal04,sum04)
  load_links_normal06 = append(load_links_normal06,sum06)
  load_links_normal08 = append(load_links_normal08,sum08)
  load_links_normal1 = append(load_links_normal1,sum1)
  load_links_normal12 = append(load_links_normal12,sum12)
}

max_sum02 <- max(load_links_normal02)
max_sum04 <- max(load_links_normal04)
max_sum06 <- max(load_links_normal06)
max_sum08 <- max(load_links_normal08)
max_sum1 <- max(load_links_normal1)
max_sum12 <- max(load_links_normal12)

set_max <- c(max_sum02,max_sum04,max_sum06,max_sum08,max_sum1,max_sum12)
general_max <- max(set_max)

load_links_normal02 = load_links_normal02/general_max
load_links_normal04 = load_links_normal04/general_max
load_links_normal06 = load_links_normal06/general_max
load_links_normal08 = load_links_normal08/general_max
load_links_normal1 = load_links_normal1/general_max
load_links_normal12 = load_links_normal12/general_max
```


```{r echo=FALSE, results=FALSE, warning=FALSE}
#Sum by events normalized - Backhaul

load_links_optic02_cloud <- load_links_optic02 %>% filter(load_links_optic02$Link == "('MBS0', 'MBS2')"  & load_links_optic02$Link != "('MBS0', 'MBS1')")
load_links_optic04_cloud <- load_links_optic04 %>% filter(load_links_optic04$Link == "('MBS0', 'MBS2')"  & load_links_optic04$Link != "('MBS0', 'MBS1')")
load_links_optic06_cloud <- load_links_optic06 %>% filter(load_links_optic06$Link == "('MBS0', 'MBS2')"  & load_links_optic06$Link != "('MBS0', 'MBS1')")
load_links_optic08_cloud <- load_links_optic08 %>% filter(load_links_optic08$Link == "('MBS0', 'MBS2')"  & load_links_optic08$Link != "('MBS0', 'MBS1')")
load_links_optic1_cloud <- load_links_optic1 %>% filter(load_links_optic1$Link == "('MBS0', 'MBS2')"  & load_links_optic1$Link != "('MBS0', 'MBS1')")
load_links_optic12_cloud <- load_links_optic12 %>% filter(load_links_optic12$Link == "('MBS0', 'MBS2')"  & load_links_optic12$Link != "('MBS0', 'MBS1')")

load_link_sd_event02_cloud <- c()
load_link_sd_event04_cloud <- c()
load_link_sd_event06_cloud <- c()
load_link_sd_event08_cloud <- c()
load_link_sd_event1_cloud <- c()
load_link_sd_event12_cloud <- c()

load_links_normal02_cloud <- c()
load_links_normal04_cloud <- c()
load_links_normal06_cloud <- c()
load_links_normal08_cloud <- c()
load_links_normal1_cloud <- c()
load_links_normal12_cloud <- c()

for (i in 1:n){
  
  load_links_n02_cloud <- load_links_optic02_cloud %>% filter(load_links_optic02_cloud$Event == i)
  load_links_n04_cloud <- load_links_optic04_cloud %>% filter(load_links_optic04_cloud$Event == i)
  load_links_n06_cloud <- load_links_optic06_cloud %>% filter(load_links_optic06_cloud$Event == i)
  load_links_n08_cloud <- load_links_optic08_cloud %>% filter(load_links_optic08_cloud$Event == i)
  load_links_n1_cloud <- load_links_optic1_cloud %>% filter(load_links_optic1_cloud$Event == i)
  load_links_n12_cloud <- load_links_optic12_cloud %>% filter(load_links_optic12_cloud$Event == i)
  
  sum02_cloud <- sum(load_links_n02_cloud$Total_Load) 
  sum04_cloud <- sum(load_links_n04_cloud$Total_Load) 
  sum06_cloud <- sum(load_links_n06_cloud$Total_Load)
  sum08_cloud <- sum(load_links_n08_cloud$Total_Load)
  sum1_cloud <- sum(load_links_n1_cloud$Total_Load)
  sum12_cloud <- sum(load_links_n12_cloud$Total_Load)
  
  load_link_sd_event02_cloud <- append(load_link_sd_event02_cloud, sd(load_links_n02_cloud$Total_Load)) 
  load_link_sd_event04_cloud <- append(load_link_sd_event04_cloud, sd(load_links_n04_cloud$Total_Load)) 
  load_link_sd_event06_cloud <- append(load_link_sd_event06_cloud, sd(load_links_n06_cloud$Total_Load))
  load_link_sd_event08_cloud <- append(load_link_sd_event08_cloud, sd(load_links_n08_cloud$Total_Load))
  load_link_sd_event1_cloud <- append(load_link_sd_event1_cloud, sd(load_links_n1_cloud$Total_Load))
  load_link_sd_event12_cloud <- append(load_link_sd_event12_cloud, sd(load_links_n12_cloud$Total_Load))
  
  load_links_normal02_cloud = append(load_links_normal02_cloud,sum02_cloud)
  load_links_normal04_cloud = append(load_links_normal04_cloud,sum04_cloud)
  load_links_normal06_cloud = append(load_links_normal06_cloud,sum06_cloud)
  load_links_normal08_cloud = append(load_links_normal08_cloud,sum08_cloud)
  load_links_normal1_cloud = append(load_links_normal1_cloud,sum1_cloud)
  load_links_normal12_cloud = append(load_links_normal12_cloud,sum12_cloud)
}

max_sum02_cloud <- max(load_links_normal02_cloud)
max_sum04_cloud <- max(load_links_normal04_cloud)
max_sum06_cloud <- max(load_links_normal06_cloud)
max_sum08_cloud <- max(load_links_normal08_cloud)
max_sum1_cloud <- max(load_links_normal1_cloud)
max_sum12_cloud <- max(load_links_normal12_cloud)

set_max_cloud <- c(max_sum02_cloud,max_sum04_cloud,max_sum06_cloud,max_sum08_cloud,max_sum1_cloud,max_sum12_cloud)
general_max_cloud <- max(set_max_cloud)

load_links_normal02_cloud = load_links_normal02_cloud/general_max_cloud
load_links_normal04_cloud = load_links_normal04_cloud/general_max_cloud
load_links_normal06_cloud = load_links_normal06_cloud/general_max_cloud
load_links_normal08_cloud = load_links_normal08_cloud/general_max_cloud
load_links_normal1_cloud = load_links_normal1_cloud/general_max_cloud
load_links_normal12_cloud = load_links_normal12_cloud/general_max_cloud
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#Simple Moving Average
# cache_hit_SMA02 <- TTR::SMA(cache_vs_cloud02$Cache, n=1)
# cache_hit_SMA04 <- TTR::SMA(cache_vs_cloud04$Cache, n=1)
# cache_hit_SMA06 <- TTR::SMA(cache_vs_cloud06$Cache, n=1)
# cache_hit_SMA08 <- TTR::SMA(cache_vs_cloud08$Cache, n=1)
# cache_hit_SMA1 <- TTR::SMA(cache_vs_cloud1$Cache, n=1)
# cache_hit_SMA12 <- TTR::SMA(cache_vs_cloud12$Cache, n=1)
# 
# cache_miss_SMA02 <- TTR::SMA(cache_vs_cloud02$Cloud, n=1)
# cache_miss_SMA04 <- TTR::SMA(cache_vs_cloud04$Cloud, n=1)
# cache_miss_SMA06 <- TTR::SMA(cache_vs_cloud06$Cloud, n=1)
# cache_miss_SMA08 <- TTR::SMA(cache_vs_cloud08$Cloud, n=1)
# cache_miss_SMA1 <- TTR::SMA(cache_vs_cloud1$Cloud, n=1)
# cache_miss_SMA12 <- TTR::SMA(cache_vs_cloud12$Cloud, n=1)
# 
# ratio_server_use_SMA02 <- TTR::SMA(ratio_server_use02, n=1)
# ratio_server_use_SMA04 <- TTR::SMA(ratio_server_use04, n=1)
# ratio_server_use_SMA06 <- TTR::SMA(ratio_server_use06, n=1)
# ratio_server_use_SMA08 <- TTR::SMA(ratio_server_use08, n=1)
# ratio_server_use_SMA1 <- TTR::SMA(ratio_server_use1, n=1)
# ratio_server_use_SMA12 <- TTR::SMA(ratio_server_use12, n=1)
# 
# load_links_SMA02 <- TTR::SMA(load_links_normal02, n=1)
# load_links_SMA04 <- TTR::SMA(load_links_normal04, n=1)
# load_links_SMA06 <- TTR::SMA(load_links_normal06, n=1)
# load_links_SMA08 <- TTR::SMA(load_links_normal08, n=1)
# load_links_SMA1 <- TTR::SMA(load_links_normal1, n=1)
# load_links_SMA12 <- TTR::SMA(load_links_normal12, n=1)

```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# Normal sd
# load_link_sd_event02 <- load_link_sd_event02 /general_max
# load_link_sd_event04 <- load_link_sd_event04  /general_max
# load_link_sd_event06 <- load_link_sd_event06  /general_max
# load_link_sd_event08 <- load_link_sd_event08  /general_max
# load_link_sd_event1 <- load_link_sd_event1  /general_max
# load_link_sd_event12 <- load_link_sd_event12 /general_max
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#Calc bounds sd in SMA
# ratio_server_use_sd_top_02 <- ratio_server_use02 + sd(ratio_server_use02)
# ratio_server_use_sd_top_04 <- ratio_server_use04 + sd(ratio_server_use04)
# ratio_server_use_sd_top_06 <- ratio_server_use06 + sd(ratio_server_use06)
# ratio_server_use_sd_top_08 <- ratio_server_use08 + sd(ratio_server_use08)
# ratio_server_use_sd_top_1 <- ratio_server_use1 + sd(ratio_server_use1)
# ratio_server_use_sd_top_12 <- ratio_server_use12 + sd(ratio_server_use12)
# 
# ratio_server_use_sd_bottom_02 <- ratio_server_use02 - sd(ratio_server_use02)
# ratio_server_use_sd_bottom_04 <- ratio_server_use04 - sd(ratio_server_use04)
# ratio_server_use_sd_bottom_06 <- ratio_server_use06 - sd(ratio_server_use06)
# ratio_server_use_sd_bottom_08 <- ratio_server_use08 - sd(ratio_server_use08)
# ratio_server_use_sd_bottom_1 <- ratio_server_use1 - sd(ratio_server_use1)
# ratio_server_use_sd_bottom_12 <- ratio_server_use12 - sd(ratio_server_use12)
# 
# load_links_normal_sd_top_02 <- load_links_SMA02 + load_link_sd_event02
# load_links_normal_sd_top_04 <- load_links_SMA04 + load_link_sd_event04
# load_links_normal_sd_top_06 <- load_links_SMA06 + load_link_sd_event06
# load_links_normal_sd_top_08 <- load_links_SMA08 + load_link_sd_event08
# load_links_normal_sd_top_1 <- load_links_SMA1 + load_link_sd_event1
# load_links_normal_sd_top_12 <- load_links_SMA12 + load_link_sd_event12
# 
# load_links_normal_sd_bottom_02 <- load_links_SMA02 - load_link_sd_event02
# load_links_normal_sd_bottom_04 <- load_links_SMA04 - load_link_sd_event04
# load_links_normal_sd_bottom_06 <- load_links_SMA06 - load_link_sd_event06
# load_links_normal_sd_bottom_08 <- load_links_SMA08 - load_link_sd_event08
# load_links_normal_sd_bottom_1 <- load_links_SMA1 - load_link_sd_event1
# load_links_normal_sd_bottom_12 <- load_links_SMA12 - load_link_sd_event12
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#create columns
type_cache <- rep("Cache Hit",100)
d1_02 <- data.frame(event=c(cache_vs_cloud02$Event),
                    func =  cache_vs_cloud02$Cache,
                    type = type_cache,
                    stringsAsFactors = FALSE)
type_cloud <- rep("Cache Miss",100)
d2_02 <- data.frame(event=c(cache_vs_cloud02$Event),
                    func =  cache_vs_cloud02$Cloud,
                    type = type_cloud,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_server_use <- rep("Uso do Armazenamento",100)
}else{
  type_server_use <- rep("Storage Load",100)
}
d3_02 <- data.frame(event=c(rep(1:100,1)),
                    func =  ratio_server_use02,
                    type = type_server_use,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_network_load <- rep("Carga da Rede Óptica",100)
}else{
  type_network_load <- rep("Optical Network Load",100)
}
d4_02 <- data.frame(event=c(rep(1:100,1)),
                    func =  load_links_normal02,
                    type = type_network_load,
                    stringsAsFactors = FALSE)

type_cache <- rep("Cache Hit",100)
d1_04 <- data.frame(event=c(cache_vs_cloud04$Event),
                    func = cache_vs_cloud04$Cache,
                    type = type_cache,
                    stringsAsFactors = FALSE)
type_cloud <- rep("Cache Miss",100)
d2_04 <- data.frame(event=c(cache_vs_cloud04$Event),
                    func = cache_vs_cloud04$Cloud,
                    type = type_cloud,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_server_use <- rep("Uso do Armazenamento",100)
}else{
  type_server_use <- rep("Storage Load",100)
}
d3_04 <- data.frame(event=c(rep(1:100,1)),
                    func = ratio_server_use04,
                    type = type_server_use,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_network_load <- rep("Carga da Rede Óptica",100)
}else{
  type_network_load <- rep("Optical Network Load",100)
}
d4_04 <- data.frame(event=c(rep(1:100,1)),
                    func = load_links_normal04,
                    type = type_network_load,
                    stringsAsFactors = FALSE)

type_cache <- rep("Cache Hit",100)
d1_06 <- data.frame(event=c(cache_vs_cloud06$Event),
                    func = cache_vs_cloud06$Cache,
                    type = type_cache,
                    stringsAsFactors = FALSE)
type_cloud <- rep("Cache Miss",100)
d2_06 <- data.frame(event=c(cache_vs_cloud06$Event),
                    func = cache_vs_cloud06$Cloud,
                    type = type_cloud,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_server_use <- rep("Uso do Armazenamento",100)
}else{
  type_server_use <- rep("Storage Load",100)
}

d3_06 <- data.frame(event=c(rep(1:100,1)),
                    func = ratio_server_use06,
                    type = type_server_use,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_network_load <- rep("Carga da Rede Óptica",100)
}else{
  type_network_load <- rep("Optical Network Load",100)
}
d4_06 <- data.frame(event=c(rep(1:100,1)),
                    func = load_links_normal06,
                    type = type_network_load,
                    stringsAsFactors = FALSE)

type_cache <- rep("Cache Hit",100)
d1_08 <- data.frame(event=c(cache_vs_cloud08$Event),
                    func = cache_vs_cloud08$Cache,
                    type = type_cache,
                    stringsAsFactors = FALSE)
type_cloud <- rep("Cache Miss",100)
d2_08 <- data.frame(event=c(cache_vs_cloud08$Event),
                    func = cache_vs_cloud08$Cloud,
                    type = type_cloud,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_server_use <- rep("Uso do Armazenamento",100)
}else{
  type_server_use <- rep("Storage Load",100)
}
d3_08 <- data.frame(event=c(rep(1:100,1)),
                    func = ratio_server_use08,
                    type = type_server_use,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_network_load <- rep("Carga da Rede Óptica",100)
}else{
  type_network_load <- rep("Optical Network Load",100)
}
d4_08 <- data.frame(event=c(rep(1:100,1)),
                    func = load_links_normal08,
                    type = type_network_load,
                    stringsAsFactors = FALSE)

type_cache <- rep("Cache Hit",100)
d1_1 <- data.frame(event=c(cache_vs_cloud1$Event),
                   func = cache_vs_cloud1$Cache,
                   type = type_cache,
                   stringsAsFactors = FALSE)
type_cloud <- rep("Cache Miss",100)
d2_1 <- data.frame(event=c(cache_vs_cloud1$Event),
                   func = cache_vs_cloud1$Cloud,
                   type = type_cloud,
                   stringsAsFactors = FALSE)
if (save_pt){
  type_server_use <- rep("Uso do Armazenamento",100)
}else{
  type_server_use <- rep("Storage Load",100)
}
d3_1 <- data.frame(event=c(rep(1:100,1)),
                   func = ratio_server_use1,
                   type = type_server_use,
                   stringsAsFactors = FALSE)
if (save_pt){
  type_network_load <- rep("Carga da Rede Óptica",100)
}else{
  type_network_load <- rep("Optical Network Load",100)
}
d4_1 <- data.frame(event=c(rep(1:100,1)),
                   func = load_links_normal1,
                   type = type_network_load,
                   stringsAsFactors = FALSE)

type_cache <- rep("Cache Hit",100)
d1_12 <- data.frame(event=c(cache_vs_cloud12$Event),
                    func = cache_vs_cloud12$Cache,
                    type = type_cache,
                    stringsAsFactors = FALSE)
type_cloud <- rep("Cache Miss",100)
d2_12 <- data.frame(event=c(cache_vs_cloud12$Event),
                    func = cache_vs_cloud12$Cloud,
                    type = type_cloud,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_server_use <- rep("Uso do Armazenamento",100)
}else{
  type_server_use <- rep("Storage Load",100)
}
d3_12 <- data.frame(event=c(rep(1:100,1)),
                    func = ratio_server_use12,
                    type = type_server_use,
                    stringsAsFactors = FALSE)
if (save_pt){
  type_network_load <- rep("Carga da Rede Óptica",100)
}else{
  type_network_load <- rep("Optical Network Load",100)
}
d4_12 <- data.frame(event=c(rep(1:100,1)),
                    func = load_links_normal12,
                    type = type_network_load,
                    stringsAsFactors = FALSE)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#create columns to Storage Load SMA
# type_server_use_sma <- rep("20%",100)
# d3_02sl_sma <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use_SMA02,
#                     type = type_server_use,
#                     top = ratio_server_use_sd_top_02,
#                     bottom = ratio_server_use_sd_bottom_02,
#                     stringsAsFactors = FALSE)
# 
# type_server_use_sma <- rep("40%",100)
# d3_04sl_sma <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use_SMA04,
#                     type = type_server_use,
#                     top = ratio_server_use_sd_top_04,
#                     bottom = ratio_server_use_sd_bottom_04,
#                     stringsAsFactors = FALSE)
# 
# type_server_use_sma <- rep("60%",100)
# d3_06sl_sma <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use_SMA06,
#                     type = type_server_use,
#                     top = ratio_server_use_sd_top_06,
#                     bottom = ratio_server_use_sd_bottom_06,
#                     stringsAsFactors = FALSE)

# type_server_use_sma <- rep("80%",100)
# d3_08sl_sma <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use_SMA08,
#                     type = type_server_use,
#                     top = ratio_server_use_sd_top_08,
#                     bottom = ratio_server_use_sd_bottom_08,
#                     stringsAsFactors = FALSE)
# 
# type_server_use_sma <- rep("100%",100)
# d3_1sl_sma <- data.frame(event=c(rep(1:100,1)),
#                    func =  ratio_server_use_SMA1,
#                    type = type_server_use,
#                    top = ratio_server_use_sd_top_1,
#                    bottom = ratio_server_use_sd_bottom_1,
#                    stringsAsFactors = FALSE)
# 
# type_server_use_sma <- rep("120%",100)
# d3_12sl_sma <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use_SMA12,
#                     type = type_server_use,
#                     top = ratio_server_use_sd_top_12,
#                     bottom = ratio_server_use_sd_bottom_12,
#                     stringsAsFactors = FALSE)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#create columns to load links SMA
# type_network_load <- rep("20%",100)
# d4_02ll_sma <- data.frame(event=c(rep(1:100,1)),
#                     func =  load_links_SMA02,
#                     type = type_network_load,
#                     top = load_links_normal_sd_top_02,
#                     bottom = load_links_normal_sd_bottom_02,
#                     stringsAsFactors = FALSE)
# 
# type_network_load <- rep("40%",100)
# d4_04ll_sma <- data.frame(event=c(rep(1:100,1)),
#                     func =  load_links_SMA04,
#                     type = type_network_load,
#                     top = load_links_normal_sd_top_04,
#                     bottom = load_links_normal_sd_bottom_04,
#                     stringsAsFactors = FALSE)
# 
# type_network_load <- rep("60%",100)
# d4_06ll_sma <- data.frame(event=c(rep(1:100,1)),
#                     func = load_links_SMA06,
#                     type = type_network_load,
#                     top = load_links_normal_sd_top_06,
#                     bottom = load_links_normal_sd_bottom_06,
#                     stringsAsFactors = FALSE)

# type_network_load <- rep("80%",100)
# d4_08ll_sma <- data.frame(event=c(rep(1:100,1)),
#                     func = load_links_SMA08,
#                     type = type_network_load,
#                     top = load_links_normal_sd_top_08,
#                     bottom = load_links_normal_sd_bottom_08,
#                     stringsAsFactors = FALSE)
# 
# type_network_load <- rep("100%",100)
# d4_1ll_sma <- data.frame(event=c(rep(1:100,1)),
#                    func = load_links_SMA1,
#                    type = type_network_load,
#                    top = load_links_normal_sd_top_1,
#                     bottom = load_links_normal_sd_bottom_1,
#                    stringsAsFactors = FALSE)
# 
# type_network_load <- rep("120%",100)
# d4_12ll_sma <- data.frame(event=c(rep(1:100,1)),
#                     func = load_links_SMA12,
#                     type = type_network_load,
#                     top = load_links_normal_sd_top_12,
#                     bottom = load_links_normal_sd_bottom_12,
#                     stringsAsFactors = FALSE)

```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#create columns to Storage Load 
# type_server_use <- rep("20%",100)
# d3_02sl <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use02,
#                     type = type_server_use,
#                     stringsAsFactors = FALSE)
# 
# type_server_use <- rep("40%",100)
# d3_04sl <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use04,
#                     type = type_server_use,
#                     stringsAsFactors = FALSE)
# 
# type_server_use <- rep("60%",100)
# d3_06sl <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use06,
#                     type = type_server_use,
#                     stringsAsFactors = FALSE)

# type_server_use <- rep("80%",100)
# d3_08sl <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use08,
#                     type = type_server_use,
#                     stringsAsFactors = FALSE)
# 
# type_server_use <- rep("100%",100)
# d3_1sl <- data.frame(event=c(rep(1:100,1)),
#                    func =  ratio_server_use1,
#                    type = type_server_use,
#                    stringsAsFactors = FALSE)
# 
# type_server_use <- rep("120%",100)
# d3_12sl <- data.frame(event=c(rep(1:100,1)),
#                     func =  ratio_server_use12,
#                     type = type_server_use,
#                     stringsAsFactors = FALSE)

```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# type_network_load <- rep("20%",100)
# d4_02ll <- data.frame(event=c(rep(1:100,1)),
#                     func =  load_links_normal02,
#                     type = type_network_load,
#                     stringsAsFactors = FALSE)
# 
# type_network_load <- rep("40%",100)
# d4_04ll <- data.frame(event=c(rep(1:100,1)),
#                     func =  load_links_normal04,
#                     type = type_network_load,
#                     stringsAsFactors = FALSE)
# 
# type_network_load <- rep("60%",100)
# d4_06ll <- data.frame(event=c(rep(1:100,1)),
#                     func = load_links_normal06,
#                     type = type_network_load,
#                     stringsAsFactors = FALSE)

# type_network_load <- rep("80%",100)
# d4_08ll <- data.frame(event=c(rep(1:100,1)),
#                     func = load_links_normal08,
#                     type = type_network_load,
#                     stringsAsFactors = FALSE)
# 
# type_network_load <- rep("100%",100)
# d4_1ll <- data.frame(event=c(rep(1:100,1)),
#                    func = load_links_normal1,
#                    type = type_network_load,
#                    stringsAsFactors = FALSE)
# 
# type_network_load <- rep("120%",100)
# d4_12ll <- data.frame(event=c(rep(1:100,1)),
#                     func = load_links_normal12,
#                     type = type_network_load,
#                     stringsAsFactors = FALSE)

```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#join columns
df_02 <- bind_rows(d1_02,d2_02,d3_02)
df_04 <- bind_rows(d1_04,d2_04,d3_02)
df_06 <- bind_rows(d1_06,d2_06,d3_06)
df_08 <- bind_rows(d1_08,d2_08,d3_08)
# df_1 <- bind_rows(d1_1,d2_1,d3_1)
# df_12 <- bind_rows(d1_12,d2_12,d3_12)

# df_02_sma <- bind_rows(d4_02,d3_02)
# df_04_sma <- bind_rows(d4_04,d3_04)
# df_06_sma <- bind_rows(d4_06,d3_06)
# df_08_sma <- bind_rows(d4_08,d3_08)
# df_1_sma <- bind_rows(d4_1,d3_1)
# df_12_sma <- bind_rows(d4_12,d3_12)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#join columns
# df_server_load_sma <- bind_rows(d3_02sl_sma,d3_04sl_sma,d3_06sl_sma)
# df_load_links_optic_sma <- bind_rows(d4_02ll_sma,d4_04ll_sma,d4_06ll_sma)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#join columns
# df_server_load <- bind_rows(d3_02sl,d3_04sl,d3_06sl)
# df_load_links_optic <- bind_rows(d4_02ll,d4_04ll,d4_06ll)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
if (save_pt){
  x.lab <- "Eventos"
  y.lab <- "Percentual"
}else{
  x.lab <- "Events"
  y.lab <- "Percentage"
}
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# g1_server_load_sma <- ggplot(df_server_load_sma, aes(fill=type, y=func, x=event, group=type,color=type)) +
#   geom_line(position="identity", stat="identity",size=1)+ylim(0, 1)+
#   geom_ribbon(aes(ymin =  bottom, ymax =  top),alpha=0.25, color=NA)+
#   theme_bw()+
#   theme(legend.position = "top",
#         #legend.direction = "vertical",
#         #legend.box = "horizontal",
#         #legend.justification = c("right", "top"),
#         #legend.box.background = element_rect(color="black", size=1),
#         #legend.box.just = "right",
#         #legend.margin = margin(4, 4, 4, 2),
#         legend.title = element_blank(),
#         legend.text = element_text(size = 18),
#         axis.text=element_text(size=16),
#         axis.title=element_text(size=16))+
#   xlab(x.lab)+
#   ylab(y.lab)
# 
# g2_load_links_sma <- ggplot(df_load_links_optic_sma, aes(fill=type, y=func, x=event,group=type,color=type)) +
#   geom_line(position="identity", stat="identity", size=1)+ylim(0, 1)+
#   geom_ribbon(aes(ymin =  bottom, ymax =  top),alpha=0.25, color=NA)+
#   theme_bw()+
#   theme(legend.position = "top",
#         #legend.direction = "vertical",
#         #legend.box = "horizontal",
#         #legend.justification = c("right", "top"),
#         #legend.box.background = element_rect(color="black", size=1),
#         #legend.box.just = "right",
#         #legend.margin = margin(4, 4, 4, 2),
#         legend.title = element_blank(),
#         legend.text = element_text(size = 18),
#         axis.text=element_text(size=16),
#         axis.title=element_text(size=16))+
#   xlab(x.lab)+
#   ylab(y.lab)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# g1_server_load <- ggplot(df_server_load, aes(fill=type, y=func, x=event, group=type,color=type)) +
#   geom_line(position="identity", stat="identity",size=1)+ylim(0, 1)+
#   theme_bw()+
#   theme(legend.position = "top",
#         #legend.direction = "vertical",
#         #legend.box = "horizontal",
#         #legend.justification = c("right", "top"),
#         #legend.box.background = element_rect(color="black", size=1),
#         #legend.box.just = "right",
#         #legend.margin = margin(4, 4, 4, 2),
#         legend.title = element_blank(),
#         legend.text = element_text(size = 18),
#         axis.text=element_text(size=16),
#         axis.title=element_text(size=16))+
#   xlab(x.lab)+
#   ylab(y.lab)
# 
# g2_load_links <- ggplot(df_load_links_optic, aes(fill=type, y=func, x=event,group=type,color=type)) +
#   geom_line(position="identity", stat="identity", size=1)+ ylim(0, 1)+
#   theme_bw()+
#   theme(legend.position = "top",
#         #legend.direction = "vertical",
#         #legend.box = "horizontal",
#         #legend.justification = c("right", "top"),
#         #legend.box.background = element_rect(color="black", size=1),
#         #legend.box.just = "right",
#         #legend.margin = margin(4, 4, 4, 2),
#         legend.title = element_blank(),
#         legend.text = element_text(size = 18),
#         axis.text=element_text(size=16),
#         axis.title=element_text(size=16))+
#   xlab(x.lab)+
#   ylab(y.lab)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
g1 <- ggplot(df_02) + 
  geom_density(position="identity", stat="identity", alpha=0.25, size=1,aes( y=func, x=event, fill=type, group=type))+
  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

g2 <- ggplot(df_04) + 
  geom_density(position="identity", stat="identity", alpha=0.25, size=1,aes( y=func, x=event, fill=type, group=type))+
  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

g3 <- ggplot(df_06) +
  geom_density(position="identity", stat="identity", alpha=0.25, size=1,aes( y=func, x=event, fill=type, group=type))+
  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

g4 <- ggplot(df_08) + 
  geom_density(position="identity", stat="identity", alpha=0.25, size=1,aes( y=func, x=event, fill=type, group=type))+
  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

# g5 <- ggplot(df_1) + 
#   geom_density(position="identity", stat="identity", alpha=0.25, size=1,aes( y=func, x=event, fill=type, group=type))+
#   theme_bw()+
#   theme(legend.position = "top",
#         legend.direction = "vertical",
#         legend.box = "horizontal",
#         #legend.justification = c("right", "top"),
#         #legend.box.background = element_rect(color="black", size=1),
#         #legend.box.just = "right",
#         #legend.margin = margin(4, 4, 4, 2),
#         legend.title = element_blank(),
#         legend.text = element_text(size = 18),
#         axis.text=element_text(size=16),
#         axis.title=element_text(size=16))+
#   xlab(x.lab)+
#   ylab(y.lab)
# 
# g6 <- ggplot(df_12) + 
#   geom_density(position="identity", stat="identity", alpha=0.25, size=1,aes( y=func, x=event, fill=type, group=type))+
#   theme_bw()+
#   theme(legend.position = "top",
#         legend.direction = "vertical",
#         legend.box = "horizontal",
#         #legend.justification = c("right", "top"),
#         #legend.box.background = element_rect(color="black", size=1),
#         #legend.box.just = "right",
#         #legend.margin = margin(4, 4, 4, 2),
#         legend.title = element_blank(),
#         legend.text = element_text(size = 18),
#         axis.text=element_text(size=16),
#         axis.title=element_text(size=16))+
#   xlab(x.lab)+
#   ylab(y.lab)
```

```{r echo=FALSE, results=FALSE, warning=FALSE, fig.width=12, fig.height=8}
# plot_grid(g1, g2, g3, g4,labels = c('2m', '4m', '6m', '8m','10m','40m'), label_x=0,label_size = 10,label_y = 1,ncol = 2,nrow = 2)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
if (save_pt){
  # ggsave(g1_server_load_sma,filename = "graph/network_aware/pt/storage/storage_server_load_sma.png", dpi = 600)
  # ggsave(g2_load_links_sma,filename = "graph/network_aware/pt/storage/storage_load_links_sma.png", dpi = 600)
  # ggsave(g1_server_load,filename = "graph/network_aware/pt/storage/storage_server_load.png", dpi = 600)
  # ggsave(g2_load_links,filename = "graph/network_aware/pt/storage/storage_load_links.png", dpi = 600)
  ggsave(g1,filename = "graph/network_aware/pt/storage/storage02.pdf", dpi = 600)
  ggsave(g2,filename = "graph/network_aware/pt/storage/storage04.pdf", dpi = 600)
  ggsave(g3,filename = "graph/network_aware/pt/storage/storage06.pdf", dpi = 600)
  ggsave(g4,filename = "graph/network_aware/pt/storage/storage08.pdf", dpi = 600)
  # ggsave(g1_server_load_sma,filename = "graph/network_aware/pt/storage/storage_server_load_sma.pdf", dpi = 600)
  # ggsave(g2_load_links_sma,filename = "graph/network_aware/pt/storage/storage_load_links_sma.pdf", dpi = 600)
  # ggsave(g1_server_load,filename = "graph/network_aware/pt/storage/storage_server_load.pdf", dpi = 600)
  # ggsave(g2_load_links,filename = "graph/network_aware/pt/storage/storage_load_links.pdf", dpi = 600)
  ggsave(g1,filename = "graph/network_aware/pt/storage/storage02.png", dpi = 600)
  ggsave(g2,filename = "graph/network_aware/pt/storage/storage04.png", dpi = 600)
  ggsave(g3,filename = "graph/network_aware/pt/storage/storage06.png", dpi = 600)
  ggsave(g4,filename = "graph/network_aware/pt/storage/storage08.png", dpi = 600)
}else{
  # ggsave(g1_server_load_sma,filename = "graph/network_aware/storage/storage_server_load_sma.png", dpi = 600)
  # ggsave(g2_load_links_sma,filename = "graph/network_aware/storage/storage_load_links_sma.png", dpi = 600)
  # ggsave(g1_server_load,filename = "graph/network_aware/storage/storage_server_load.png", dpi = 600)
  # ggsave(g2_load_links,filename = "graph/network_aware/storage/storage_load_links.png", dpi = 600)
  ggsave(g1,filename = "graph/network_aware/en/storage/storage02.pdf", dpi = 600)
  ggsave(g2,filename = "graph/network_aware/en/storage/storage04.pdf", dpi = 600)
  ggsave(g3,filename = "graph/network_aware/en/storage/storage06.pdf", dpi = 600)
  ggsave(g4,filename = "graph/network_aware/en/storage/storage08.pdf", dpi = 600)
  # ggsave(g1_server_load_sma,filename = "graph/network_aware/storage/storage_server_load_sma.pdf", dpi = 600)
  # ggsave(g2_load_links_sma,filename = "graph/network_aware/storage/storage_load_links_sma.pdf", dpi = 600)
  # ggsave(g1_server_load,filename = "graph/network_aware/storage/storage_server_load.pdf", dpi = 600)
  # ggsave(g2_load_links,filename = "graph/network_aware/storage/storage_load_links.pdf", dpi = 600)
  ggsave(g1,filename = "graph/network_aware/en/storage/storage02.png", dpi = 600)
  ggsave(g2,filename = "graph/network_aware/en/storage/storage04.png", dpi = 600)
  ggsave(g3,filename = "graph/network_aware/en/storage/storage06.png", dpi = 600)
  ggsave(g4,filename = "graph/network_aware/en/storage/storage08.png", dpi = 600)
}
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# print(g1_server_load_sma)
# print(g2_load_links_sma)
# print(g1_server_load)
# print(g2_load_links)
print(g1)
print(g2)
print(g3)
print(g4)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
# delay_scale02 <- scale(delay02$Delay)
# set.seed(1)
# delay_cluster02 <- kmeans(x = delay_scale02, centers = 2)
# delay_prev02 <- delay_cluster02$cluster
# plot(delay_scale02, col=delay_prev02)
# 
# delay_scale04 <- scale(delay04$Delay)
# set.seed(1)
# delay_cluster04 <- kmeans(x = delay_scale04, centers = 2)
# delay_prev04 <- delay_cluster04$cluster
# plot(delay_scale04, col=delay_prev04)
# 
# delay_scale06 <- scale(delay06$Delay)
# set.seed(1)
# delay_cluster06 <- kmeans(x = delay_scale06, centers = 2)
# delay_prev06 <- delay_cluster06$cluster
# plot(delay_scale06, col=delay_prev06)
# 
# delay_scale08 <- scale(delay08$Delay)
# set.seed(1)
# delay_cluster08 <- kmeans(x = delay_scale08, centers = 2)
# delay_prev08 <- delay_cluster08$cluster
# plot(delay_scale08, col=delay_prev08)
# 
# delay_scale1 <- scale(delay1$Delay)
# set.seed(1)
# delay_cluster1 <- kmeans(x = delay_scale1, centers = 2)
# delay_prev1 <- delay_cluster1$cluster
# plot(delay_scale1, col=delay_prev1)
# 
# delay_scale12 <- scale(delay12$Delay)
# set.seed(1)
# delay_cluster12 <- kmeans(x = delay_scale12, centers = 2)
# delay_prev12 <- delay_cluster12$cluster
# plot(delay_scale12, col=delay_prev12)
```

<!-- ### Somatório da Carga dos enlaces ópticos por evento(normalizado pelo maior somatório). -->

```{r echo=FALSE, results=FALSE, warning=FALSE}

# x <- c(1:100)

# par(mfrow=c(3,2))
# 
# plot(ecdf(load_links_optic04$Total_Load),col="#CCE5FF")
# lines(ecdf(load_links_optic06$Total_Load),col="#36393D")
# lines(ecdf(load_links_optic08$Total_Load),col="#003366")
# lines(ecdf(load_links_optic1$Total_Load),col="#B20000")
# lines(ecdf(load_links_optic12$Total_Load),col="#647687")
# 
# plot(load_links_optic04$Total_Load,col="#CCE5FF")
# plot(load_links_optic06$Total_Load,col="#36393D")
# plot(load_links_optic08$Total_Load,col="#003366")
# plot(load_links_optic1$Total_Load,col="#B20000")
# plot(load_links_optic12$Total_Load,col="#647687")
# 
# h04 <- hist(load_links_optic04$Total_Load,col="#CCE5FF")
# h06 <- hist(load_links_optic06$Total_Load,col="#36393D")
# h08 <- hist(load_links_optic08$Total_Load,col="#003366")
# h1 <- hist(load_links_optic1$Total_Load,col="#B20000")
# h12 <- hist(load_links_optic12$Total_Load,col="#647687")
# 
# boxplot(load_links_optic04$Total_Load,col="#CCE5FF")
# boxplot(load_links_optic06$Total_Load,col="#36393D")
# boxplot(load_links_optic08$Total_Load,col="#003366")
# boxplot(load_links_optic1$Total_Load,col="#B20000")
# boxplot(load_links_optic12$Total_Load,col="#647687")

# par(mfrow=c(1,1))
# 
# plot(x,load_links_normal02,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load", ylim = c(0,1))
# model <- lm(load_links_normal02 ~ x + I(x^2) + I(x^3) )
# myPredict <- predict( model , interval="predict" )
# ix <- sort(x,index.return=T)$ix
# lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
# 
# plot(x,load_links_normal04,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load", ylim = c(0,1))
# model <- lm(load_links_normal04 ~ x + I(x^2) + I(x^3) )
# myPredict <- predict( model , interval="predict" )
# ix <- sort(x,index.return=T)$ix
# lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
# 
# plot(x,load_links_normal06,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load", ylim = c(0,1))
# model <- lm(load_links_normal06 ~ x + I(x^2) + I(x^3) )
# myPredict <- predict( model , interval="predict" )
# ix <- sort(x,index.return=T)$ix
# lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
# 
# plot(x,load_links_normal08,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load", ylim = c(0,1))
# model <- lm(load_links_normal08 ~ x + I(x^2) + I(x^3) )
# myPredict <- predict( model , interval="predict" )
# ix <- sort(x,index.return=T)$ix
# lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
# 
# plot(x,load_links_normal1,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load", ylim = c(0,1))
# model <- lm(load_links_normal1 ~ x + I(x^2) + I(x^3))
# myPredict <- predict( model , interval="predict" )
# ix <- sort(x,index.return=T)$ix
# lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
# 
# plot(x,load_links_normal12,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load", ylim = c(0,1))
# model <- lm(load_links_normal12 ~ x + I(x^2) + I(x^3))
# myPredict <- predict( model , interval="predict" )
# ix <- sort(x,index.return=T)$ix
# lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

```

<!-- ### Delay médio por evento. -->
```{r echo=FALSE, results=TRUE, warning=FALSE}
delay_links_median02 <- c()
delay_links_median04 <- c()
delay_links_median06 <- c()
delay_links_median08 <- c()
delay_links_median1 <- c()
delay_links_median12 <- c()

delay_links_sd02 <- c()
delay_links_sd04 <- c()
delay_links_sd06 <- c()
delay_links_sd08 <- c()
delay_links_sd1 <- c()
delay_links_sd12 <- c()

for (i in 1:n){
  delay_links_n02 <- delay02 %>% filter(delay02$Event == i)
  delay_links_n04 <- delay04 %>% filter(delay04$Event == i)
  delay_links_n06 <- delay06 %>% filter(delay06$Event == i)
  delay_links_n08 <- delay08 %>% filter(delay08$Event == i)
  delay_links_n1 <- delay1 %>% filter(delay1$Event == i)
  delay_links_n12 <- delay12 %>% filter(delay12$Event == i)
  
  # delay_links_median02 <- append(delay_links_median02, mean(delay_links_n02$Delay))
  # delay_links_median04 <- append(delay_links_median04, mean(delay_links_n04$Delay))
  # delay_links_median06 <- append(delay_links_median06, mean(delay_links_n06$Delay))
  # delay_links_median08 <- append(delay_links_median08, mean(delay_links_n08$Delay))
  # delay_links_median1 <- append(delay_links_median1, mean(delay_links_n1$Delay))
  # delay_links_median12 <- append(delay_links_median12, mean(delay_links_n12$Delay))
  
  # delay_links_sd02 <- append(delay_links_sd02, sd(delay_links_n02$Delay))
  # delay_links_sd04 <- append(delay_links_sd04, sd(delay_links_n04$Delay))
  # delay_links_sd06 <- append(delay_links_sd06, sd(delay_links_n06$Delay))
  # delay_links_sd08 <- append(delay_links_sd08, sd(delay_links_n08$Delay))
  # delay_links_sd1 <- append(delay_links_sd1, sd(delay_links_n1$Delay))
  # delay_links_sd12 <- append(delay_links_sd12, sd(delay_links_n12$Delay))
  
  delay_links_median02 <- append(delay_links_median02, sum(delay_links_n02$Delay))
  delay_links_median04 <- append(delay_links_median04, sum(delay_links_n04$Delay))
  # delay_links_median06 <- append(delay_links_median06, sum(delay_links_n06$Delay))
  delay_links_median08 <- append(delay_links_median08, sum(delay_links_n08$Delay))
  delay_links_median1 <- append(delay_links_median1, sum(delay_links_n1$Delay))
  delay_links_median12 <- append(delay_links_median12, sum(delay_links_n12$Delay))
  
}
# delay_links_median02 <- na.omit(delay_links_median02)
# delay_links_median04 <- na.omit(delay_links_median04)
# delay_links_median06 <- na.omit(delay_links_median06)
# delay_links_median08 <- na.omit(delay_links_median08)
# delay_links_median1 <- na.omit(delay_links_median1)
# delay_links_median12 <- na.omit(delay_links_median12)
# 
# delay_links_sd02 <- na.omit(delay_links_sd02)
# delay_links_sd04 <- na.omit(delay_links_sd04)
# delay_links_sd06 <- na.omit(delay_links_sd06)
# delay_links_sd08 <- na.omit(delay_links_sd08)
# delay_links_sd1 <- na.omit(delay_links_sd1)
# delay_links_sd12 <- na.omit(delay_links_sd12)
``` 

```{r echo=FALSE, results=FALSE, warning=FALSE}
# delay_links_sd_top02 <- delay_links_median02 + delay_links_sd02
# delay_links_sd_top04 <- delay_links_median04 + delay_links_sd04
# delay_links_sd_top06 <- delay_links_median06 + delay_links_sd06
# delay_links_sd_top08 <- delay_links_median08 + delay_links_sd08
# delay_links_sd_top1 <- delay_links_median1 + delay_links_sd1
# delay_links_sd_top12 <- delay_links_median12 + delay_links_sd12
# 
# delay_links_sd_bottom02 <- delay_links_median02 - delay_links_sd02
# delay_links_sd_bottom04 <- delay_links_median04 - delay_links_sd04
# delay_links_sd_bottom06 <- delay_links_median06 - delay_links_sd06
# delay_links_sd_bottom08 <- delay_links_median08 - delay_links_sd08
# delay_links_sd_bottom1 <- delay_links_median1 - delay_links_sd1
# delay_links_sd_bottom12 <- delay_links_median12 - delay_links_sd12
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#Create dataframe
type_storage <- rep(20,length(delay02$Delay))
d_02 <- data.frame(id = rep(1:length(delay02$Delay)),
                   delay = delay02$Delay,
                   type = type_storage,
                   # top = delay_links_sd_top02,
                   # bottom = delay_links_sd_bottom02,
                   stringsAsFactors = FALSE)

type_storage <- rep(40,length(delay04$Delay))
d_04 <- data.frame(id = rep(1:length(delay04$Delay)),
                   delay = delay04$Delay,
                   type = type_storage,
                   # top = delay_links_sd_top04,
                   # bottom = delay_links_sd_bottom04,
                   stringsAsFactors = FALSE)
type_storage <- rep(60,length(delay06$Delay))
d_06 <- data.frame(id = rep(length(delay06$Delay)),
                  delay = delay06$Delay,
                   type = type_storage,
                  # top = delay_links_sd_top06,
                  #  bottom = delay_links_sd_bottom06,
                   stringsAsFactors = FALSE)
type_storage <- rep(80,length(delay08$Delay)) #WARNING
d_08 <- data.frame(id = rep(1:length(delay08$Delay)),
                   delay = delay08$Delay,
                   type = type_storage,
                   # top = delay_links_sd_top08,
                   # bottom = delay_links_sd_bottom08,
                   stringsAsFactors = FALSE)
type_storage <- rep(100,length(delay1$Delay))
d_1 <- data.frame(id = rep(1:length(delay1$Delay)),
                  delay = delay1$Delay,
                  type = type_storage,
                  # top = delay_links_sd_top1,
                  #  bottom = delay_links_sd_bottom1,
                  stringsAsFactors = FALSE)

type_storage <- rep(120,length(delay12$Delay))
d_12 <- data.frame(id = rep(1:length(delay12$Delay)),
                   delay = delay12$Delay,
                   type = type_storage,
                   # top = delay_links_sd_top12,
                   # bottom = delay_links_sd_bottom12,
                   stringsAsFactors = FALSE)
``` 

```{r echo=FALSE, results=FALSE, warning=FALSE}
#Join dataframe
df_delay <- rbind(d_02,d_04,d_06,d_08)
# df_delay <- rbind(d_02,d_04,d_08)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#Translate
if (save_pt){
  y.lab <- "Latência"
  leg <- "Armazenamento"
}else{
  y.lab <- "Network Delay (ms)"
  leg <- "Storage"
}
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
g_delay <- ggplot(df_delay,aes(x=type, y=delay, group=type, color=type,fill=type)) +
  geom_boxplot(alpha=0.8,color="Black") + 
  theme_bw()+
  scale_x_continuous(breaks=c(20,40,60,80), labels=c("20%","40%","60%","80%"))+ #WARNING
  theme(legend.position = "none",
  #       #legend.direction = "vertical",
  #       #legend.box = "horizontal",
  #       #legend.justification = c("right", "top"),
  #       #legend.box.background = element_rect(color="black", size=1),
  #       #legend.box.just = "right",
  #       #legend.margin = margin(4, 4, 4, 2),
  #       legend.title = element_blank(),
  #       legend.text = element_text(size = 18),
         axis.text=element_text(size=16),
         axis.title=element_text(size=16))+
  ylab(y.lab) + xlab(element_blank()) +ylim(c(0,40))
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
print(g_delay)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
if (save_pt){
  ggsave(g_delay,filename = "graph/network_aware/pt/storage/storage_delay.pdf", dpi = 600)
  ggsave(g_delay,filename = "graph/network_aware/pt/storage/storage_delay.png", dpi = 600)
}else{
  ggsave(g_delay,filename = "graph/network_aware/en/storage/storage_delay.pdf", dpi = 600)
  ggsave(g_delay,filename = "graph/network_aware/en/storage/storage_delay.png", dpi = 600)
}
```

### Correlação entre proporções e variação da capacidade.
```{r echo=FALSE, results=TRUE, warning=FALSE}
#teste
# means_server_load <- c(mean(ratio_server_use02),mean(ratio_server_use04),mean(ratio_server_use06),mean(ratio_server_use08),mean(ratio_server_use1),mean(ratio_server_use12))
# cor(means_server_load,storage)

colnames(df_02) <-  c("Storage")
df_02$Storage <- rep(0.2,300)

colnames(df_04) <-  c("Storage")
df_04$Storage <- rep(0.4,300)

colnames(df_06) <-  c("Storage")
df_06$Storage <- rep(0.6,300)

colnames(df_08) <-  c("Storage")
df_08$Storage <- rep(0.8,300)

# colnames(df_1) <-  c("Zipf")
# df_1$Storage <- rep(1.0,300)
# 
# colnames(df_12) <-  c("Zipf")
# df_12$Storage <- rep(1.2,300)

#df_cor_storage <- rbind(df_02,df_04,df_06,df_08)
df_cor_storage <- rbind(df_02,df_04,df_08)
colnames(df_cor_storage) <-  c("Storage","Value","Type")

df_cor_storage_server_load <- df_cor_storage %>% filter(df_cor_storage$Type == "Storage Load") 
df_cor_storage_cache_hit <- df_cor_storage %>% filter(df_cor_storage$Type == "Cache Hit") 
df_cor_storage_cache_miss <- df_cor_storage %>% filter(df_cor_storage$Type == "Cache Miss") 

print("Storage Load")
cor(df_cor_storage_server_load$Storage,df_cor_storage_server_load$Value, method = "pearson")
print("Cache Hit")
cor(df_cor_storage_cache_hit$Storage,df_cor_storage_cache_hit$Value, method = "pearson")
print("Cache Miss")
cor(df_cor_storage_cache_miss$Storage,df_cor_storage_cache_miss$Value, method = "pearson")
```

### Correlação entre a latência e variação da capacidade.
```{r echo=FALSE, results=TRUE, warning=FALSE}
cor(df_delay$delay,df_delay$type, method = "pearson")
```

### Médias

```{r echo=FALSE, results=TRUE, warning=FALSE}
summary(delay02$Delay)
quantile(delay02$Delay)
quantile(delay02$Delay,probs = 0.95)


# delay02$Delay
# boxplot(delay02$Delay)
# hist(delay02$Delay)
# plot(delay02$Delay)
# outlier(delay02$Delay)



summary(delay04$Delay)
quantile(delay04$Delay)
quantile(delay04$Delay,probs = 0.95)


# delay04$Delay
# boxplot(delay04$Delay)
# hist(delay04$Delay)
# plot(delay04$Delay)
# outlier(delay04$Delay)


# 
# summary(delay06$Delay)
# quantile(delay06$Delay)
# quantile(delay06$Delay,probs = 0.95)


# delay06$Delay
# boxplot(delay06$Delay)
# hist(delay06$Delay)
# plot(delay06$Delay)
# outlier(delay06$Delay)



summary(delay08$Delay)
quantile(delay08$Delay)
quantile(delay08$Delay,probs = 0.95)


# delay08$Delay
# boxplot(delay08$Delay)
# hist(delay08$Delay)
# plot(delay08$Delay)
# outlier(delay08$Delay)

# summary(delay1$Delay)
# quantile(delay1$Delay)
# quantile(delay1$Delay,probs = 0.95)
# sd(delay1$Delay)
# delay1$Delay
# boxplot(delay1$Delay)
# hist(delay1$Delay)
# plot(delay1$Delay)
# outlier(delay1$Delay)
# 
# summary(delay12$Delay)
# quantile(delay12$Delay)
# quantile(delay12$Delay,probs = 0.95)
# sd(delay12$Delay)
# delay12$Delay
# boxplot(delay12$Delay)
# hist(delay12$Delay)
# plot(delay12$Delay)
# outlier(delay12$Delay)

# var(delay02$Delay)
# var(delay04$Delay)
# var(delay06$Delay)
# var(delay08$Delay)
# var(delay1$Delay)
# var(delay12$Delay)
```

### Máximos

```{r echo=FALSE, results=TRUE, warning=FALSE}

max(cache_vs_cloud04$Cloud)
min(cache_vs_cloud04$Cache)
max(ratio_server_use04)

print("Médias")
mean(cache_vs_cloud04$Cloud)
mean(cache_vs_cloud04$Cache)
mean(ratio_server_use04)
#

print("Desvios")
sd(cache_vs_cloud04$Cloud)
sd(cache_vs_cloud04$Cache)
sd(ratio_server_use04)
# #################################################################
# summary(cache_vs_cloud02$Cloud)
# summary(cache_vs_cloud02$Cache)
# summary(ratio_server_use02)
# 
# hist(cache_vs_cloud02$Cloud)
# hist(cache_vs_cloud02$Cache)
# hist(ratio_server_use02)
# 
# plot(ecdf(cache_vs_cloud02$Cloud))
# plot(ecdf(cache_vs_cloud02$Cache))
# plot(ecdf(ratio_server_use02))
# 
# mean(cache_vs_cloud02$Cloud)
# mean(cache_vs_cloud02$Cache)
# mean(ratio_server_use02)
# #
# sd(cache_vs_cloud02$Cloud)
# sd(cache_vs_cloud02$Cache)
# sd(ratio_server_use02)
# 
# max(cache_vs_cloud02$Cloud)
# max(ratio_server_use02)
# #################################################################
# summary(cache_vs_cloud04$Cloud)
# summary(cache_vs_cloud04$Cache)
# summary(ratio_server_use04)
# 
# hist(cache_vs_cloud04$Cloud)
# hist(cache_vs_cloud04$Cache)
# hist(ratio_server_use04)
# 
# plot(ecdf(cache_vs_cloud04$Cloud))
# plot(ecdf(cache_vs_cloud04$Cache))
# plot(ecdf(ratio_server_use04))
# 
# mean(cache_vs_cloud04$Cloud)
# mean(cache_vs_cloud04$Cache)
# mean(ratio_server_use04)
# 
# sd(cache_vs_cloud04$Cloud)
# sd(cache_vs_cloud04$Cache)
# sd(ratio_server_use04)
# 
# max(cache_vs_cloud04$Cloud)
# max(ratio_server_use04)
# #################################################################
# summary(cache_vs_cloud06$Cloud)
# summary(cache_vs_cloud06$Cache)
# summary(ratio_server_use06)
# 
# hist(cache_vs_cloud06$Cloud)
# hist(cache_vs_cloud06$Cache)
# hist(ratio_server_use06)
# 
# plot(ecdf(cache_vs_cloud06$Cloud))
# plot(ecdf(cache_vs_cloud06$Cache))
# plot(ecdf(ratio_server_use06))
# 
# mean(cache_vs_cloud06$Cloud)
# mean(cache_vs_cloud06$Cache)
# mean(ratio_server_use06)
# 
# max(ratio_server_use06)
# #################################################################
# summary(cache_vs_cloud08$Cloud)
# summary(cache_vs_cloud08$Cache)
# summary(ratio_server_use08)
# 
# hist(cache_vs_cloud08$Cloud)
# hist(cache_vs_cloud08$Cache)
# hist(ratio_server_use08)
# 
# plot(ecdf(cache_vs_cloud08$Cloud))
# plot(ecdf(cache_vs_cloud08$Cache))
# plot(ecdf(ratio_server_use08))
# 
# mean(cache_vs_cloud08$Cloud)
# mean(cache_vs_cloud08$Cache)
# mean(ratio_server_use08)
# # 
# sd(cache_vs_cloud08$Cloud)
# sd(cache_vs_cloud08$Cache)
# sd(ratio_server_use08)
# 
# print("teste")
# print(max(ratio_server_use08))
# #################################################################
# summary(cache_vs_cloud1$Cloud)
# summary(cache_vs_cloud1$Cache)
# summary(ratio_server_use1)
# 
# 
# hist(cache_vs_cloud1$Cloud)
# hist(cache_vs_cloud1$Cache)
# hist(ratio_server_use1)
# 
# plot(ecdf(cache_vs_cloud1$Cloud))
# plot(ecdf(cache_vs_cloud1$Cache))
# plot(ecdf(ratio_server_use1))
# 
# median(cache_vs_cloud1$Cloud)
# median(cache_vs_cloud1$Cache)
# median(ratio_server_use1)
# 
# #################################################################
# summary(cache_vs_cloud12$Cloud)
# summary(cache_vs_cloud12$Cache)
# summary(ratio_server_use12)
# 
# hist(cache_vs_cloud12$Cloud)
# hist(cache_vs_cloud12$Cache)
# hist(ratio_server_use12)
# 
# plot(ecdf(cache_vs_cloud12$Cloud))
# plot(ecdf(cache_vs_cloud12$Cache))
# plot(ecdf(ratio_server_use12))
# 
# median(cache_vs_cloud12$Cloud)
# median(cache_vs_cloud12$Cache)
# median(ratio_server_use12)
# max(summary(cache_vs_cloud12$Cloud))
```


### Somatório de Saltos por Evento - Fronthaul vs Backhaul
```{r echo=FALSE, results=TRUE, warning=FALSE}
#get last status in event

paths_last_state02 <- data.frame()
paths_last_state04 <- data.frame()
paths_last_state06 <- data.frame()
paths_last_state08 <- data.frame()
paths_last_state1 <- data.frame()
paths_last_state12 <- data.frame()

for (i in 1:n){
  paths_last_state_n_02 <- paths02 %>% filter(paths02$Event == i)
  paths_last_state02 <- rbind(paths_last_state02, paths_last_state_n_02 %>%  group_by(Request) %>% slice(n()))
  
  paths_last_state_n_04 <- paths04 %>% filter(paths04$Event == i)
  paths_last_state04 <- rbind(paths_last_state04, paths_last_state_n_04 %>%  group_by(Request) %>% slice(n()))
  
  paths_last_state_n_06 <- paths06 %>% filter(paths06$Event == i)
  paths_last_state06 <- rbind(paths_last_state06, paths_last_state_n_06 %>%  group_by(Request) %>% slice(n()))
  
  paths_last_state_n_08 <- paths08 %>% filter(paths08$Event == i)
  paths_last_state08 <- rbind(paths_last_state08, paths_last_state_n_08 %>%  group_by(Request) %>% slice(n()))
  
  paths_last_state_n_1 <- paths1 %>% filter(paths1$Event == i)
  paths_last_state1 <- rbind(paths_last_state1, paths_last_state_n_1 %>%  group_by(Request) %>% slice(n()))
  
  paths_last_state_n_12 <- paths12 %>% filter(paths12$Event == i)
  paths_last_state12 <- rbind(paths_last_state12, paths_last_state_n_12 %>%  group_by(Request) %>% slice(n()))
}
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
paths_last_state02$...1 <- NULL
paths_last_state04$...1 <- NULL
paths_last_state06$...1 <- NULL
paths_last_state08$...1 <- NULL
paths_last_state1$...1 <- NULL
paths_last_state12$...1 <- NULL
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
#filter FH and BH
paths02_cloud <- subset(paths_last_state02, Host ==  "MBS0" )
paths04_cloud <- subset(paths_last_state04, Host ==  "MBS0" )
paths06_cloud <- subset(paths_last_state06, Host ==  "MBS0" )
paths08_cloud <- subset(paths_last_state08, Host ==  "MBS0" )
paths1_cloud <- subset(paths_last_state1, Host ==  "MBS0" )
paths12_cloud <- subset(paths_last_state12, Host ==  "MBS0" )

paths02_ran <- subset(paths_last_state02, Host !=  "MBS0" )
paths04_ran <- subset(paths_last_state04, Host !=  "MBS0" )
paths06_ran <- subset(paths_last_state06, Host !=  "MBS0" )
paths08_ran <- subset(paths_last_state08, Host !=  "MBS0" )
paths1_ran <- subset(paths_last_state1, Host !=  "MBS0" )
paths12_ran <- subset(paths_last_state12, Host !=  "MBS0" )
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
#count hops = (n-1)-1 in cloud

paths02_cloud['Hops'] <- NA
paths04_cloud['Hops'] <- NA
paths06_cloud['Hops'] <- NA
paths08_cloud['Hops'] <- NA
paths1_cloud['Hops'] <- NA
paths12_cloud['Hops'] <- NA

for (row in 1:nrow(paths02_cloud)){
  count_cloud02 <- paths02_cloud[row,]$Path
  count_cloud02 <- strsplit(count_cloud02,",")
  count_cloud02 <- length(count_cloud02[[1]])
  count_cloud02 <- count_cloud02 - HOPS
  paths02_cloud[row,]$Hops <- count_cloud02
  
  #paths_hops02_cloud <- rbind(paths_hops02_cloud, paths02_cloud[row,])
}

for (row in 1:nrow(paths04_cloud)){

  count_cloud04 <- paths04_cloud[row,]$Path
  count_cloud04 <- strsplit(count_cloud04,",")
  count_cloud04 <- length(count_cloud04[[1]])
  count_cloud04 <- count_cloud04 - HOPS
  paths04_cloud[row,]$Hops <- count_cloud04

  # paths_hops04_cloud <- rbind(paths_hops04_cloud, paths04_cloud[row,])
}
for (row in 1:nrow(paths06_cloud)){

  count_cloud06 <- paths06_cloud[row,]$Path
  count_cloud06 <- strsplit(count_cloud06,",")
  count_cloud06 <- length(count_cloud06[[1]])
  count_cloud06 <- count_cloud06 - HOPS
  paths06_cloud[row,]$Hops <- count_cloud06

  # paths_hops06_cloud <- rbind(paths_hops06_cloud, paths06_cloud[row,])
}
if(nrow(paths08_cloud != 0)){
  for (row in 1:nrow(paths08_cloud)){
    
    count_cloud08 <- paths08_cloud[row,]$Path
    count_cloud08 <- strsplit(count_cloud08,",")
    count_cloud08 <- length(count_cloud08[[1]])
    count_cloud08 <- count_cloud08 - HOPS
    paths08_cloud[row,]$Hops <- count_cloud08
    
    # paths_hops08_cloud <- rbind(paths_hops08_cloud, paths08_cloud[row,])
  }
}
# for (row in 1:nrow(paths1_cloud)){
# 
#   count_cloud1 <- paths1_cloud[row,]$Path
#   count_cloud1 <- strsplit(count_cloud1,",")
#   count_cloud1 <- length(count_cloud1[[1]])
#   count_cloud1 <- count_cloud1 - HOPS
#   paths1_cloud[row,]$Hops <- count_cloud1
# 
#   # paths_hops1_cloud <- rbind(paths_hops1_cloud, paths1_cloud[row,])
# }
# for (row in 1:nrow(paths12_cloud)){
# 
#   count_cloud12 <- paths12_cloud[row,]$Path
#   count_cloud12 <- strsplit(count_cloud12,",")
#   count_cloud12 <- length(count_cloud12[[1]])
#   count_cloud12 <- count_cloud12 - HOPS
#   paths12_cloud[row,]$Hops <- count_cloud12
# 
#   # paths_hops12_cloud <- rbind(paths_hops12_cloud, paths12_cloud[row,])
# }

```

```{r echo=FALSE, results=TRUE, warning=FALSE}
#count hops = (n-1)-1 in ran

paths02_ran['Hops'] <- NA
paths04_ran['Hops'] <- NA
paths06_ran['Hops'] <- NA
paths08_ran['Hops'] <- NA
paths1_ran['Hops'] <- NA
paths12_ran['Hops'] <- NA

for (row in 1:nrow(paths02_ran)){

  count_ran02 <- paths02_ran[row,]$Path
  count_ran02 <- strsplit(count_ran02,",")
  count_ran02 <- length(count_ran02[[1]])
  count_ran02 <- count_ran02 - HOPS
  paths02_ran[row,]$Hops <- count_ran02

  # paths_hops02_ran <- rbind(paths_hops02_ran, paths02_ran[row,])
}
for (row in 1:nrow(paths04_ran)){

  count_ran04 <- paths04_ran[row,]$Path
  count_ran04 <- strsplit(count_ran04,",")
  count_ran04 <- length(count_ran04[[1]])
  count_ran04 <- count_ran04 - HOPS
  paths04_ran[row,]$Hops <- count_ran04

  # paths_hops04_ran <- rbind(paths_hops04_ran, paths04_ran[row,])
}
for (row in 1:nrow(paths06_ran)){

  count_ran06 <- paths06_ran[row,]$Path
  count_ran06 <- strsplit(count_ran06,",")
  count_ran06 <- length(count_ran06[[1]])
  count_ran06 <- count_ran06 - HOPS
  paths06_ran[row,]$Hops <- count_ran06

  # paths_hops06_ran <- rbind(paths_hops06_ran, paths06_ran[row,])
}
for (row in 1:nrow(paths08_ran)){

  count_ran08 <- paths08_ran[row,]$Path
  count_ran08 <- strsplit(count_ran08,",")
  count_ran08 <- length(count_ran08[[1]])
  count_ran08 <- count_ran08 - HOPS
  paths08_ran[row,]$Hops <- count_ran08

  # paths_hops08_ran <- rbind(paths_hops08_ran, paths08_ran[row,])
}
# for (row in 1:nrow(paths1_ran)){
# 
#   count_ran1 <- paths1_ran[row,]$Path
#   count_ran1 <- strsplit(count_ran1,",")
#   count_ran1 <- length(count_ran1[[1]])
#   count_ran1 <- count_ran1 - HOPS
#   paths1_ran[row,]$Hops <- count_ran1
# 
#   # paths_hops1_ran <- rbind(paths_hops1_ran, paths1_ran[row,])
# }
# for (row in 1:nrow(paths12_ran)){
# 
#   count_ran12 <- paths12_ran[row,]$Path
#   count_ran12 <- strsplit(count_ran12,",")
#   count_ran12 <- length(count_ran12[[1]])
#   count_ran12 <- count_ran12 - HOPS
#   paths12_ran[row,]$Hops <- count_ran12
# 
#   # paths_hops12_ran <- rbind(paths_hops12_ran, paths12_ran[row,])
# }
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
# sum each event (cloud)

sum02_cloud <- c()
sum04_cloud <- c()
sum06_cloud <- c()
sum08_cloud <- c()
sum1_cloud <- c()
sum12_cloud <- c()

paths_sum_n_cloud_02 <- data.frame()
paths_sum_n_cloud_04 <- data.frame()
paths_sum_n_cloud_06 <- data.frame()
paths_sum_n_cloud_08 <- data.frame()
paths_sum_n_cloud_1 <- data.frame()
paths_sum_n_cloud_12 <- data.frame()

sum02 <- sum04 <- sum06 <- sum08 <- sum1 <- sum12 <- NA

for (i in 1:n){
  paths_sum_n_cloud_02 <- subset(paths02_cloud, Event == i)
  sum02 <- sum(paths_sum_n_cloud_02$Hops)
  sum02_cloud <- append(sum02_cloud, sum02)
  sum02 <- NA 
}

for (i in 1:n){
  paths_sum_n_cloud_04 <- subset(paths04_cloud, Event == i)
  sum04 <- sum(paths_sum_n_cloud_04$Hops)
  sum04_cloud <- append(sum04_cloud, sum04)
  sum04 <- NA 
}

for (i in 1:n){
  paths_sum_n_cloud_06 <- subset(paths06_cloud, Event == i)
  sum06 <- sum(paths_sum_n_cloud_06$Hops)
  sum06_cloud <- append(sum06_cloud, sum06)
  sum06 <- NA 
}

for (i in 1:n){
  paths_sum_n_cloud_08 <- subset(paths08_cloud, Event == i)
  sum08 <- sum(paths_sum_n_cloud_08$Hops)
  sum08_cloud <- append(sum08_cloud, sum08)
  sum08 <- NA 
}

# for (i in 1:n){
#   paths_sum_n_cloud_1 <- subset(paths1_cloud, Event == i)
#   sum1 <- sum(paths_sum_n_cloud_1$Hops)
#   sum1_cloud <- append(sum1_cloud, sum1)
#   sum1 <- NA 
# }
# 
# for (i in 1:n){
#   paths_sum_n_cloud_12 <- subset(paths12_cloud, Event == i)
#   sum12 <- sum(paths_sum_n_cloud_12$Hops)
#   sum12_cloud <- append(sum12_cloud, sum12)
#   sum12 <- NA 
# }
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
# sum each event (ran)

sum02_ran <- c()
sum04_ran <- c()
sum06_ran <- c()
sum08_ran <- c()
sum1_ran <- c()
sum12_ran <- c()

paths_sum_n_ran_02 <- data.frame()
paths_sum_n_ran_04 <- data.frame()
paths_sum_n_ran_06 <- data.frame()
paths_sum_n_ran_08 <- data.frame()
paths_sum_n_ran_1 <- data.frame()
paths_sum_n_ran_12 <- data.frame()

sum02 <- sum04 <- sum06 <- sum08 <- sum1 <- sum12 <- NA

for (i in 1:n){
  paths_sum_n_ran_02 <- subset(paths02_ran, Event == i)
  sum02 <- sum(paths_sum_n_ran_02$Hops)
  sum02_ran <- append(sum02_ran, sum02)
  sum02 <- NA 
}

for (i in 1:n){
  paths_sum_n_ran_04 <- subset(paths04_ran, Event == i)
  sum04 <- sum(paths_sum_n_ran_04$Hops)
  sum04_ran <- append(sum04_ran, sum04)
  sum04 <- NA 
}

for (i in 1:n){
  paths_sum_n_ran_06 <- subset(paths06_ran, Event == i)
  sum06 <- sum(paths_sum_n_ran_06$Hops)
  sum06_ran <- append(sum06_ran, sum06)
  sum06 <- NA 
}

for (i in 1:n){
  paths_sum_n_ran_08 <- subset(paths08_ran, Event == i)
  sum08 <- sum(paths_sum_n_ran_08$Hops)
  sum08_ran <- append(sum08_ran, sum08)
  sum08 <- NA 
}

# for (i in 1:n){
#   paths_sum_n_ran_1 <- subset(paths1_ran, Event == i)
#   sum1 <- sum(paths_sum_n_ran_1$Hops)
#   sum1_ran <- append(sum1_ran, sum1)
#   sum1 <- NA 
# }
# 
# for (i in 1:n){
#   paths_sum_n_ran_12 <- subset(paths12_ran, Event == i)
#   sum12 <- sum(paths_sum_n_ran_12$Hops)
#   sum12_ran <- append(sum12_ran, sum12)
#   sum12 <- NA 
# }
```

```{r echo=FALSE, results=TRUE, warning=FALSE}

sum_hops_cloud_normal02 <- get_hops_cloud_normalized(sum02_cloud,sum02_ran)
sum_hops_ran_normal02 <- get_hops_ran_normalized(sum02_cloud,sum02_ran)

sum_hops_cloud_normal04 <- get_hops_cloud_normalized(sum04_cloud,sum04_ran)
sum_hops_ran_normal04 <- get_hops_ran_normalized(sum04_cloud,sum04_ran)

sum_hops_cloud_normal06 <- get_hops_cloud_normalized(sum06_cloud,sum06_ran)
sum_hops_ran_normal06 <- get_hops_ran_normalized(sum06_cloud,sum06_ran)

sum_hops_cloud_normal08 <- get_hops_cloud_normalized(sum08_cloud,sum08_ran)
sum_hops_ran_normal08 <- get_hops_ran_normalized(sum08_cloud,sum08_ran)

# sum_hops_cloud_normal1 <- get_hops_cloud_normalized(sum1_cloud,sum1_ran)
# sum_hops_ran_normal1 <- get_hops_ran_normalized(sum1_cloud,sum1_ran)
# 
# sum_hops_cloud_normal12 <- get_hops_cloud_normalized(sum12_cloud,sum12_ran)
# sum_hops_ran_normal12 <- get_hops_ran_normalized(sum12_cloud,sum12_ran)
```


```{r echo=FALSE, results=TRUE, warning=FALSE}
#create dataframes cloud

type_cloud = rep("Backhaul", 100)

df_sum_hops_cloud_02 = data.frame(
  event = c(rep(1:100,1)),
  sum_hops = sum02_cloud,
  type = type_cloud,
  storage = rep("0.2",100),
                   stringsAsFactors = FALSE
)

df_sum_hops_cloud_04 = data.frame(
  event =  c(rep(1:100,1)),
  sum_hops = sum04_cloud,
  type = type_cloud,
  storage = rep("0.4",100),
                   stringsAsFactors = FALSE
)
df_sum_hops_cloud_06 = data.frame(
  event =  c(rep(1:100,1)),
  sum_hops = sum06_cloud,
  type = type_cloud,
  storage = rep("0.6",100),
                   stringsAsFactors = FALSE
)
df_sum_hops_cloud_08 = data.frame(
  event =  c(rep(1:100,1)),
  sum_hops = sum08_cloud,
  type = type_cloud,
  storage = rep("0.8",100),
                   stringsAsFactors = FALSE
)
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
#create dataframes ran

type_ran = rep("Fronthaul", 100)
df_sum_hops_ran_02 = data.frame(
  event =  c(rep(1:100,1)),
  sum_hops = sum02_ran,
  type = type_ran,
  storage = rep("0.2",100),
                   stringsAsFactors = FALSE
)
df_sum_hops_ran_04 = data.frame(
  event =  c(rep(1:100,1)),
  sum_hops = sum04_ran,
  type = type_ran,
  storage = rep("0.4",100),
                   stringsAsFactors = FALSE
)
df_sum_hops_ran_06 = data.frame(
  event =  c(rep(1:100,1)),
  sum_hops = sum06_ran,
  type = type_ran,
  storage = rep("0.6",100),
                   stringsAsFactors = FALSE
)
df_sum_hops_ran_08 = data.frame(
  event =  c(rep(1:100,1)),
  sum_hops = sum08_ran,
  type = type_ran,
  storage = rep("0.8",100),
                   stringsAsFactors = FALSE
)
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
#create dataframes - join cloud and ran
df_sum_hops_02 <- bind_rows(df_sum_hops_cloud_02,df_sum_hops_ran_02)
df_sum_hops_04 <- bind_rows(df_sum_hops_cloud_04,df_sum_hops_ran_04)
df_sum_hops_06 <- bind_rows(df_sum_hops_cloud_06,df_sum_hops_ran_06)
df_sum_hops_08 <- bind_rows(df_sum_hops_cloud_08,df_sum_hops_ran_08)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#Translate
if (save_pt){
  y.lab <- "Total de Número de Saltos"
  x.lab <- "Events"
}else{
  y.lab <- "Path Size (Hops)"
  x.lab <- "Eventos"
}
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
#make graph/network_aware
  
sum_hops_02 <- ggplot(df_sum_hops_02, aes(fill=type, y=sum_hops, x=event)) + 
  geom_bar(position="fill", stat="identity")+

  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

sum_hops_04 <- ggplot(df_sum_hops_04, aes(fill=type, y=sum_hops, x=event)) + 
  geom_bar(position="fill", stat="identity")+

  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

sum_hops_06 <- ggplot(df_sum_hops_06, aes(fill=type, y=sum_hops, x=event)) + 
  geom_bar(position="fill", stat="identity")+

  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

sum_hops_08 <- ggplot(df_sum_hops_08, aes(fill=type, y=sum_hops, x=event)) + 
  geom_bar(position="fill", stat="identity")+

  theme_bw()+
  theme(legend.position = "top",
        # legend.direction = "vertical",
        legend.box = "horizontal",
        #legend.justification = c("right", "top"),
        #legend.box.background = element_rect(color="black", size=1),
        #legend.box.just = "right",
        #legend.margin = margin(4, 4, 4, 2),
        legend.title = element_blank(),
        legend.text = element_text(size = 18),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16))+
  xlab(x.lab)+
  ylab(y.lab)

```

```{r echo=FALSE, results=FALSE, warning=FALSE}
print(sum_hops_02)
print(sum_hops_04)
# print(sum_hops_06)
print(sum_hops_08)
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
if (save_pt){
  ggsave(sum_hops_02,filename = "graph/network_aware/pt/storage/sum_hops02.pdf", dpi = 600)
  ggsave(sum_hops_02,filename = "graph/network_aware/pt/storage/sum_hops02.png", dpi = 600)
  ggsave(sum_hops_04,filename = "graph/network_aware/pt/storage/sum_hops04.pdf", dpi = 600)
  ggsave(sum_hops_04,filename = "graph/network_aware/pt/storage/sum_hops04.png", dpi = 600)
  ggsave(sum_hops_06,filename = "graph/network_aware/pt/storage/sum_hops06.pdf", dpi = 600)
  ggsave(sum_hops_06,filename = "graph/network_aware/pt/storage/sum_hops06.png", dpi = 600)
  ggsave(sum_hops_08,filename = "graph/network_aware/pt/storage/sum_hops08.pdf", dpi = 600)
  ggsave(sum_hops_08,filename = "graph/network_aware/pt/storage/sum_hops08.png", dpi = 600)
  # ggsave(sum_hops_1,filename = "graph/network_aware/pt/storage/sum_hops1.pdf", dpi = 600)
  # ggsave(sum_hops_1,filename = "graph/network_aware/pt/storage/sum_hops1.png", dpi = 600)
}else{
  ggsave(sum_hops_02,filename = "graph/network_aware/en/storage/sum_hops02.pdf", dpi = 600)
  ggsave(sum_hops_02,filename = "graph/network_aware/en/storage/sum_hops02.png", dpi = 600)
  ggsave(sum_hops_04,filename = "graph/network_aware/en/storage/sum_hops04.pdf", dpi = 600)
  ggsave(sum_hops_04,filename = "graph/network_aware/en/storage/sum_hops04.png", dpi = 600)
  ggsave(sum_hops_06,filename = "graph/network_aware/en/storage/sum_hops06.pdf", dpi = 600)
  ggsave(sum_hops_06,filename = "graph/network_aware/en/storage/sum_hops06.png", dpi = 600)
  ggsave(sum_hops_08,filename = "graph/network_aware/en/storage/sum_hops08.pdf", dpi = 600)
  ggsave(sum_hops_08,filename = "graph/network_aware/en/storage/sum_hops08.png", dpi = 600)
  # ggsave(sum_hops_1,filename = "graph/network_aware/storage/sum_hops1.pdf", dpi = 600)
  # ggsave(sum_hops_1,filename = "graph/network_aware/storage/sum_hops1.png", dpi = 600)
}
``` 

### Network Load - Fronthaul vs Backhaul
```{r echo=FALSE, results=TRUE, warning=FALSE}
#total requests by event - qos * \lambda - thp_min - single link - best case
total_requests_load_02 <- get_total_requests_load(poisson02,qos,n)
total_requests_load_04 <- get_total_requests_load(poisson04,qos,n)
total_requests_load_06 <- get_total_requests_load(poisson06,qos,n)
total_requests_load_08 <- get_total_requests_load(poisson08,qos,n)
# total_requests_load_1 <- get_total_requests_load(poisson1,qos,n)
# total_requests_load_12 <- get_total_requests_load(poisson12,qos,n)
#get total requests load normalized
#total_requests_load <- total_requests_load / max(total_requests_load)

```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#total load BH
thp_cur_cloud_02_raw <- get_total_load(paths02_cloud,rtt02,n,BUFFER)
thp_cur_cloud_04_raw <- get_total_load(paths04_cloud,rtt04,n,BUFFER)
thp_cur_cloud_06_raw <- get_total_load(paths06_cloud,rtt06,n,BUFFER)
thp_cur_cloud_08_raw <- get_total_load(paths08_cloud,rtt08,n,BUFFER)
# thp_cur_cloud_1 <- get_total_load(paths1_cloud,n,BUFFER)
# thp_cur_cloud_12 <- get_total_load(paths12_cloud,n,BUFFER)

thp_cur_cloud_02 <- fit_sd(thp_cur_cloud_02_raw)
thp_cur_cloud_04 <- fit_sd(thp_cur_cloud_04_raw)
thp_cur_cloud_06 <- fit_sd(thp_cur_cloud_06_raw)
thp_cur_cloud_08 <- fit_sd(thp_cur_cloud_08_raw)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#total load FH
thp_cur_ran_02_raw <- get_total_load(paths02_ran,rtt02,n,BUFFER)
thp_cur_ran_04_raw <- get_total_load(paths04_ran,rtt04,n,BUFFER)
thp_cur_ran_06_raw <- get_total_load(paths06_ran,rtt06,n,BUFFER)
thp_cur_ran_08_raw <- get_total_load(paths08_ran,rtt08,n,BUFFER)
# thp_cur_ran_1 <- get_total_load(paths1_ran,n,BUFFER)
# thp_cur_ran_12 <- get_total_load(paths12_ran,n,BUFFER)

thp_cur_ran_02 <- fit_sd(thp_cur_ran_02_raw)
thp_cur_ran_04 <- fit_sd(thp_cur_ran_04_raw)
thp_cur_ran_06 <- fit_sd(thp_cur_ran_06_raw)
thp_cur_ran_08 <- fit_sd(thp_cur_ran_08_raw)
```

```{r echo=FALSE, results=FALSE, warning=FALSE}
#avg load in links FH

#get total optical link
total_optical_link  <- scattering_optic02$All[1]
#correct bug in calc all optics links
total_optical_link <- total_optical_link - (2*15) - (NUM_MBS/2)

#WARNING: falta remover os BH. 
#load_links_optic02_ran <- subset(load_links_optic02, Link == )
avg_thp_cur_ran_02 <- avg_load_links(load_links_optic02,qos,n)
avg_thp_cur_ran_04 <- avg_load_links(load_links_optic04,qos,n)
avg_thp_cur_ran_06 <- avg_load_links(load_links_optic06,qos,n)
avg_thp_cur_ran_08 <- avg_load_links(load_links_optic08,qos,n)
# avg_thp_cur_ran_1 <- avg_load_links(load_links_optic1,qos,n)
# avg_thp_cur_ran_12 <- avg_load_links(load_links_optic12,qos,n)
```

```{r echo=FALSE, warning=FALSE, results=FALSE}
#create dataframes
df_load_02 <- create_df_network_load(total_requests_load_02,thp_cur_cloud_02,thp_cur_ran_02,avg_thp_cur_ran_02,save_pt)
df_load_04 <- create_df_network_load(total_requests_load_04,thp_cur_cloud_04,thp_cur_ran_04,avg_thp_cur_ran_04,save_pt)
df_load_06 <- create_df_network_load(total_requests_load_06,thp_cur_cloud_06,thp_cur_ran_06,avg_thp_cur_ran_06,save_pt)
df_load_08 <- create_df_network_load(total_requests_load_08,thp_cur_cloud_08,thp_cur_ran_08,avg_thp_cur_ran_08,save_pt)
# df_load_1 <- create_df_network_load(total_requests_load_1,thp_cur_cloud_1,thp_cur_ran_1,avg_thp_cur_ran_1)
# df_load_12 <- create_df_network_load(total_requests_load_12,thp_cur_cloud_12,thp_cur_ran_12,avg_thp_cur_ran_12)
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
#plot graph/network_awares
load_network_02 <- plot_graphs_network_load(df_load_02,save_pt)
load_network_04 <- plot_graphs_network_load(df_load_04,save_pt)
load_network_06 <- plot_graphs_network_load(df_load_06,save_pt)
load_network_08 <- plot_graphs_network_load(df_load_08,save_pt)
# load_network_1 <- plot_graphs_network_load(df_load_1,save_pt)
# load_network_12 <- plot_graphs_network_load(df_load_12,save_pt)
``` 

```{r echo=FALSE, results=FALSE, warning=FALSE}
#show graph
print(load_network_02)
print(load_network_04)
print(load_network_06)
print(load_network_08)
# print(load_network_1)
# print(load_network_12)
```

```{r echo=FALSE, results=TRUE, warning=FALSE}
if (save_pt){
  ggsave(load_network_02,filename = "graph/network_aware/pt/storage/load_bh_fh02.pdf", dpi = 600)
  ggsave(load_network_02,filename = "graph/network_aware/pt/storage/load_bh_fh02.png", dpi = 600)
  ggsave(load_network_04,filename = "graph/network_aware/pt/storage/load_bh_fh04.pdf", dpi = 600)
  ggsave(load_network_04,filename = "graph/network_aware/pt/storage/load_bh_fh04.png", dpi = 600)
  ggsave(load_network_06,filename = "graph/network_aware/pt/storage/load_bh_fh06.pdf", dpi = 600)
  ggsave(load_network_06,filename = "graph/network_aware/pt/storage/load_bh_fh06.png", dpi = 600)
  ggsave(load_network_08,filename = "graph/network_aware/pt/storage/load_bh_fh08.pdf", dpi = 600)
  ggsave(load_network_08,filename = "graph/network_aware/pt/storage/load_bh_fh08.png", dpi = 600)
  # ggsave(sum_hops_1,filename = "graph/network_aware/pt/storage/load_bh_fh1.pdf", dpi = 600)
  # ggsave(sum_hops_1,filename = "graph/network_aware/pt/storage/load_bh_fh1.png", dpi = 600)
}else{
  ggsave(load_network_02,filename = "graph/network_aware/en/storage/load_bh_fh02.pdf", dpi = 600)
  ggsave(load_network_02,filename = "graph/network_aware/en/storage/load_bh_fh02.png", dpi = 600)
  ggsave(load_network_04,filename = "graph/network_aware/en/storage/load_bh_fh04.pdf", dpi = 600)
  ggsave(load_network_04,filename = "graph/network_aware/en/storage/load_bh_fh04.png", dpi = 600)
  ggsave(load_network_06,filename = "graph/network_aware/en/storage/load_bh_fh06.pdf", dpi = 600)
  ggsave(load_network_06,filename = "graph/network_aware/en/storage/load_bh_fh06.png", dpi = 600)
  ggsave(load_network_08,filename = "graph/network_aware/en/storage/load_bh_fh08.pdf", dpi = 600)
  ggsave(load_network_08,filename = "graph/network_aware/en/storage/load_bh_fh08.png", dpi = 600)
  ggsave(sum_hops_1,filename = "graph/network_aware/storage/sum_hops1.pdf", dpi = 600)
  ggsave(sum_hops_1,filename = "graph/network_aware/storage/sum_hops1.png", dpi = 600)
}
``` 