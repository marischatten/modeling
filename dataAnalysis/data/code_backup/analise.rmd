---
title: "ZipF"
author: "Marisangila Alves"
date: "10/21/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr)
library(ggplot2)
library(plyr)
library(viridis)
library(hrbrthemes)
```

```{r echo=FALSE, message=FALSE}
# zipf 0.4
rate_admission04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless04 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc04 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc04 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson04 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Poisson', col_names=TRUE))
zipf04 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Zipf', col_names=TRUE))
times04 <- read.table("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.dat", header = TRUE)
delay04 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf04_lambda5fixo.xlsx", sheet='Delay', col_names=TRUE))

# zipf 0.6
rate_admission06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless06 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc06 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc06 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson06 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Poisson', col_names=TRUE))
zipf06 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Zipf', col_names=TRUE))
times06 <- read.table("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.dat", header = TRUE)
delay06 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf06_lambda5fixo.xlsx", sheet='Delay', col_names=TRUE))

# zipf 0.8
rate_admission08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless08 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc08 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc08 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson08 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Poisson', col_names=TRUE))
zipf08 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Zipf', col_names=TRUE))
times08 <- read.table("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.dat", header = TRUE)
delay08 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf08_lambda5fixo.xlsx", sheet='Delay', col_names=TRUE))

# zipf 1.0
rate_admission1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless1 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc1 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc1 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson1 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Poisson', col_names=TRUE))
zipf1 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Zipf', col_names=TRUE))
times1 <- read.table("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.dat", header = TRUE)
delay1 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf10_lambda5fixo.xlsx", sheet='Delay', col_names=TRUE))

# zipf 1.2
rate_admission12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Rate_Admission', col_names=TRUE))
server_use12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Server_Use', col_names=TRUE))
cache_vs_cloud12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='CacheVsCloud', col_names=TRUE))
server_use_by_type12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Server_Use_By_Type', col_names=TRUE))
scattering_optic12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Scattering_Optic', col_names=TRUE))
scattering_wireless12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Scattering_Wireless', col_names=TRUE))
load_links_optic12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Load_Links_Optic', col_names=TRUE))
load_links_wireless12 <- data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Load_Links_Wireless', col_names=TRUE))
path_Realloc12 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Paths_Reallocation', col_names=TRUE))
host_Realloc12 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Hosts_Reallocation', col_names=TRUE))

poisson12 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Poisson', col_names=TRUE))
zipf12 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Zipf', col_names=TRUE))
times12 <- read.table("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.dat", header = TRUE)
delay12 = data.frame(read_excel("../dataAnalysis/data/zipf/instance_zipf12_lambda5fixo.xlsx", sheet='Delay', col_names=TRUE))


zipf = c(0.4,0.6,0.8,1.0,1.2)
lambda <- 5
n <- 100
beta <- 0.2
mobility <- 40

bs <- unique(server_use04$BS)
server_use_bs_by_n1 <- matrix(ncol=n)
server_use_bs_by_n04 <- matrix(ncol=n)
server_use_bs_by_n0 <- matrix(ncol=n)

```
### Parâmetros

          Parâmetros      | Valores
    ----------------------|----------
    alfa zipf             | `r zipf` 
    lambda                | `r lambda`
    n                     | `r n`
    beta                  | `r beta`
    BS                    | `r length(bs)-1`
    Cache                 | 100
    UE                    | 200
    Storage               | MBS 20GB SBS 4GB
    Coverage              | MBS 300 SBS 70
    RTT inicial           | CS/MBS 0.001s(1ms) MBS/MBS 0.001s(1ms) MBS/SBS 0.001s(1ms) SBS/UE 0.001s(1ms)
    Tempo da Requisição   | 10 eventos
    Mobilidade            | `r mobility`m
    
    
### Informações da Aplicação.

      Vazão Mínima |     Tamanho da Cache        | Buffer |
    ---------------|-----------------------------|--------|
       100 Mbps    |      2GB/2000MB             |  48Mb  |
       100 Mbps    |      4GB/4000MB             |  48Mb  |
       100 Mbps    |      8GB/8000MB             |  48Mb  |
       

   
### Tempo de execução da otimização.

```{r echo=FALSE, message=FALSE, results=FALSE, warning=FALSE}

max_time04 <- max(times04$times)
times.optimize04 <- times04$times[times04$times != max_time04]
events04 <- c(1:length(times.optimize04))
times_df04 <- data.frame(events04,times.optimize04)

max_time06 <- max(times06$times)
times.optimize06 <- times06$times[times06$times != max_time06]
events06 <- c(1:length(times.optimize06))
times_df06 <- data.frame(events06,times.optimize06)

max_time08 <- max(times08$times)
times.optimize08 <- times08$times[times08$times != max_time08]
events08 <- c(1:length(times.optimize08))
times_df08 <- data.frame(events08,times.optimize08)

max_time1 <- max(times1$times)
times.optimize1 <- times1$times[times1$times != max_time1]
events1 <- c(1:length(times.optimize1))
times_df1 <- data.frame(events1,times.optimize1)

max_time12 <- max(times12$times)
times.optimize12 <- times12$times[times12$times != max_time12]
events12 <- c(1:length(times.optimize12))
times_df12 <- data.frame(events12,times.optimize12)

plot(type = "l",times_df04,col="#CCE5FF",xlab = "Requests",ylab = "Time Execution", ylim = c(0,600))
lines(times_df06,col="#36393D")
lines(times_df08,col="#003366")
lines(times_df1,col="#B20000")
lines(times_df12,col="#647687")
legend(x = "bottomright", 
       legend = c(expression(paste(alpha, " = ", 0.4)), expression(paste(alpha, " = ", 0.6)),expression(paste(alpha, " = ", 0.8)), expression(paste(alpha, " = ", 1.0)),expression(paste(alpha, " = ", 1.2))),
       col = c("#CCE5FF", "#36393D", "#003366", "#B20000", "#647687"), 
       horiz = F ,
       lty = 1,
       lwd = 5, 
       bty = "n")

```

<!-- ### Distribuição das Requisições. -->


```{r echo=FALSE, warning=FALSE, results=FALSE, message=FALSE}
#par(mflow= c(2,3))
#hist(poisson1$Qtd_Requests, freq=F, col=c("#CCE5FF"))
#hist(poisson04$Qtd_Requests, freq=F, col=c(rgb(0,0,1,0.5)))
#hist(poisson0$Qtd_Requests, freq=F, col=c(rgb(0,0,1,0.5)))
#lines(density(poisson1$Qtd_Requests))
```

### Distribuição de popularidade do conteúdo solicitado.

```{r echo=FALSE, message=FALSE, results=TRUE, warning=FALSE}
zipf04 <- count(zipf04, "Caches")
zipf4 <- zipf04[order(zipf04$freq,decreasing = TRUE),]
zipf06 <- count(zipf06, "Caches")
zipf06 <- zipf06[order(zipf06$freq,decreasing = TRUE),]
zipf08 <- count(zipf08, "Caches")
zipf08 <- zipf08[order(zipf08$freq,decreasing = TRUE),]
zipf1 <- count(zipf1, "Caches")
zipf1 <- zipf1[order(zipf1$freq,decreasing = TRUE),]
zipf12 <- count(zipf12, "Caches")
zipf12 <- zipf12[order(zipf12$freq,decreasing = TRUE),]
old.par <- par(mfrow=c(3, 2))
hist(zipf04$freq,breaks = "FD" ,freq=F,col=c("#CCE5FF"))
hist(zipf06$freq,breaks = "FD" ,freq=F,col=c("#36393D"))
hist(zipf08$freq,breaks = "FD" ,freq=F,col=c("#003366"))
hist(zipf1$freq,breaks = "FD" ,freq=F,col=c("#B20000"))
hist(zipf12$freq,breaks = "FD" ,freq=F,col=c("#647687"))
par(old.par)
```

### Taxa de requisições alocadas.

$\alpha : 0.4 =$ `r  round(rate_admission04$Rate_Admission,4) * 100`% -  `r rate_admission04$Admission_Requests`/`r rate_admission04$All_Requests`.

$\alpha : 0.6 =$ `r  round(rate_admission06$Rate_Admission,4) * 100`% -  `r rate_admission06$Admission_Requests`/`r rate_admission06$All_Requests`.

$\alpha : 0.8 =$ `r  round(rate_admission08$Rate_Admission,4) * 100`% -  `r rate_admission08$Admission_Requests`/`r rate_admission08$All_Requests`.

$\alpha : 1.0 =$ `r  round(rate_admission1$Rate_Admission,4) * 100`% -  `r rate_admission1$Admission_Requests`/`r rate_admission1$All_Requests`.

$\alpha : 1.2 =$ `r  round(rate_admission12$Rate_Admission,4) * 100`% -  `r rate_admission12$Admission_Requests`/`r rate_admission12$All_Requests`.

### Delay médio por evento.
```{r echo=FALSE, results=TRUE, warning=FALSE}

delay_links_means04 <- c()
delay_links_means06 <- c()
delay_links_means08 <- c()
delay_links_means1 <- c()
delay_links_means12 <- c()

delay_links_median04 <- c()
delay_links_median06 <- c()
delay_links_median08 <- c()
delay_links_median1 <- c()
delay_links_median12 <- c()

delay_links_sd04 <- c()
delay_links_sd06 <- c()
delay_links_sd08 <- c()
delay_links_sd1 <- c()
delay_links_sd12 <- c()

delay_links_median04 <- c()
delay_links_median06 <- c()
delay_links_median08 <- c()
delay_links_median1 <- c()
delay_links_median12 <- c()

for (i in 1:n){
   delay_links_n04 <- delay04 %>% filter(delay04$Event == i)
   delay_links_n06 <- delay06 %>% filter(delay06$Event == i)
   delay_links_n08 <- delay08 %>% filter(delay08$Event == i)
   delay_links_n1 <- delay1 %>% filter(delay1$Event == i)
   delay_links_n12 <- delay12 %>% filter(delay12$Event == i)

   delay_mean04 <- mean(delay_links_n04$Delay)
   delay_mean06 <- mean(delay_links_n06$Delay)
   delay_mean08 <- mean(delay_links_n08$Delay)
   delay_mean1 <- mean(delay_links_n1$Delay)
   delay_mean12 <- mean(delay_links_n12$Delay)

   delay_median04 <- median(delay_links_n04$Delay)
   delay_median06 <-  median(delay_links_n06$Delay)
   delay_median08 <-  median(delay_links_n08$Delay)
   delay_median1 <-  median(delay_links_n1$Delay)
   delay_median12 <-  median(delay_links_n12$Delay)

   delay_sd04 <- sd(delay_links_n04$Delay)
   delay_sd06 <- sd(delay_links_n06$Delay)
   delay_sd08 <- sd(delay_links_n08$Delay)
   delay_sd1 <- sd(delay_links_n1$Delay)
   delay_sd12 <- sd(delay_links_n12$Delay)

   delay_links_means04 = append(delay_links_means04,delay_mean04)
   delay_links_means06 = append(delay_links_means06,delay_mean06)
   delay_links_means08 = append(delay_links_means08,delay_mean08)
   delay_links_means1 = append(delay_links_means1,delay_mean1)
   delay_links_means12 = append(delay_links_means12,delay_mean12)

   delay_links_median04 = append(delay_links_median04,delay_median04)
   delay_links_median06 = append(delay_links_median06,delay_median06)
   delay_links_median08 = append(delay_links_median08,delay_median08)
   delay_links_median1 = append(delay_links_median1,delay_median1)
   delay_links_median12 = append(delay_links_median12,delay_median12)

   delay_links_sd04 = append(delay_links_sd04,delay_sd04)
   delay_links_sd06 = append(delay_links_sd06,delay_sd06)
   delay_links_sd08 = append(delay_links_sd08,delay_sd08)
   delay_links_sd1 = append(delay_links_sd1,delay_sd1)
   delay_links_sd12 = append(delay_links_sd12,delay_sd12)
 }

 delay_links_means04 <- na.omit(delay_links_means04)
 delay_links_means06 <- na.omit(delay_links_means06)
 delay_links_means08 <- na.omit(delay_links_means08)
 delay_links_means1 <- na.omit(delay_links_means1)
 delay_links_means12 <- na.omit(delay_links_means12)

 delay_links_median04 <- na.omit(delay_links_median04)
 delay_links_median06 <- na.omit(delay_links_median06)
 delay_links_median08 <- na.omit(delay_links_median08)
 delay_links_median1 <- na.omit(delay_links_median1)
 delay_links_median12 <- na.omit(delay_links_median12)

 delay_links_sd04 <- na.omit(delay_links_sd04)
 delay_links_sd06 <- na.omit(delay_links_sd06)
 delay_links_sd08 <- na.omit(delay_links_sd08)
 delay_links_sd1 <- na.omit(delay_links_sd1)
 delay_links_sd12 <- na.omit(delay_links_sd12)

 delay_sd_top04 <- delay_links_means04+delay_links_sd04
 delay_sd_bottom04 <- delay_links_means04-delay_links_sd04
 delay_sd_top06 <- delay_links_means06+delay_links_sd06
 delay_sd_bottom06 <- delay_links_means06-delay_links_sd06
 delay_sd_top08 <- delay_links_means08+delay_links_sd08
 delay_sd_bottom08 <- delay_links_means08-delay_links_sd08
 delay_sd_top1 <- delay_links_means1+delay_links_sd1
 delay_sd_bottom1 <- delay_links_means1-delay_links_sd1
 delay_sd_top12 <- delay_links_means12+delay_links_sd12
 delay_sd_bottom12 <- delay_links_means12-delay_links_sd12

 # summary(delay_links_means04)
 # summary(delay_links_means06)
 # summary(delay_links_means08)
 # summary(delay_links_means1)
 # summary(delay_links_means12)
 #
 # summary(delay_links_median04)
 # summary(delay_links_median06)
 # summary(delay_links_median08)
 # summary(delay_links_median1)
 # summary(delay_links_median12)

 x <- c(1:99)
 
 y04 <-delay_links_means04[1:99]
 y06 <-delay_links_means06[1:99]
 y08 <-delay_links_means08[1:99]
 y1 <-delay_links_means1[1:99]
 y12 <-delay_links_means12[1:99]
 
 # summary(delay1$Delay)
 # summary(y)
 #par(mfrow=c(2,2))
 plot(ecdf(delay04$Delay),col="#619CFF")
 #lines(ecdf(delay06$Delay),col="#36393D")
 #lines(ecdf(delay08$Delay),col="#003366")
 #lines(ecdf(delay1$Delay),col="#B20000")
 #lines(ecdf(delay12$Delay),col="#647687") 

 plot(ecdf(y04),col="#619CFF")
 
 plot(delay04$Delay,col="#619CFF")
 plot(delay06$Delay,col="#36393D")
 plot(delay08$Delay,col="#003366")
 plot(delay1$Delay,col="#B20000")
 plot(delay12$Delay,col="#647687")
 
 h04 <- hist(delay04$Delay,col="#619CFF")
 h06 <- hist(delay06$Delay,col="#36393D")
 h08 <- hist(delay08$Delay,col="#003366")
 h1 <- hist(delay1$Delay,col="#B20000")
 h12 <- hist(delay12$Delay,col="#647687")

 boxplot(delay04$Delay,col="#619CFF")
 boxplot(delay06$Delay,col="#36393D")
 boxplot(delay08$Delay,col="#003366")
 boxplot(delay1$Delay,col="#B20000")
 boxplot(delay12$Delay,col="#647687")

 #c("#CCE5FF", "#36393D", "#003366", "#B20000", "#647687")
 #ar(mfrow=c(3,2))
 
 plot(x,y04,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 model <- lm(y04 ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
 plot(x,y06,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 model <- lm(y06 ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
 plot(x,y08,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 model <- lm(y08 ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
 plot(x,y1,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 model <- lm(y1 ~ x + I(x^2) + I(x^3))
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
 plot(x,y12,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 model <- lm(y12 ~ x + I(x^2) + I(x^3))
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
 

 #plot(delay_links_means04, type="l",xlab = "Events",ylab = "Average Delay ",col="#CCE5FF") 
 #lines(delay_sd_top1,col="#4682B4") 
 #lines(delay_sd_bottom1,col="#4682B4") 
 #lines(delay_sd_top04,col="#B22222") 
 #lines(delay_sd_bottom04,col="#B22222") 
 #lines(delay_sd_top0,col="#339966") 
 #lines(delay_sd_bottom0,col="#339966") 
 # lines(delay_links_means06,col="#36393D") 
 # lines(delay_links_means08,col="#EEEEEE") 
 # lines(delay_links_means1,col="#B20000") 
 # lines(delay_links_means12,col="#647687") 
 # legend(x = "bottomright", 
 #       legend = c(expression(paste(alpha, " = ", 0.4)), expression(paste(alpha, " = ", 0.6)),expression(paste(alpha, " = ", 0.8)), expression(paste(alpha, " = ", 1.0)),expression(paste(alpha, " = ", 1.2))),
 #       col = c("#CCE5FF", "#36393D", "#EEEEEE", "#B20000", "#647687"), 
 #       #horiz = F ,
 #       lty = 1,
 #       lwd = 5, 
 #       bty = "n") 
 # title(main = "Delay médio.") 
``` 

### Carga média de enlaces ópticos por evento.


```{r echo=FALSE, results=FALSE, warning=FALSE}
o_load_links_means04 <- c()
o_load_links_means06 <- c()
o_load_links_means08 <- c()
o_load_links_means1 <- c()
o_load_links_means12 <- c()

o_load_links_median04 <- c()
o_load_links_median06 <- c()
o_load_links_median08 <- c()
o_load_links_median1 <- c()
o_load_links_median12 <- c()

o_load_links_sd04 <- c()
o_load_links_sd06 <- c()
o_load_links_sd08 <- c()
o_load_links_sd1 <- c()
o_load_links_sd12 <- c()


for (i in 1:n){

  o_load_links_n04 <- load_links_optic04 %>% filter(load_links_optic04$Event == i)
  o_load_links_n06 <- load_links_optic06 %>% filter(load_links_optic06$Event == i)
  o_load_links_n08 <- load_links_optic08 %>% filter(load_links_optic08$Event == i)
  o_load_links_n1 <- load_links_optic1 %>% filter(load_links_optic1$Event == i)
  o_load_links_n12 <- load_links_optic12 %>% filter(load_links_optic12$Event == i)

  o_mean04 <- mean(o_load_links_n04$Total_Load)
  o_mean06 <- mean(o_load_links_n06$Total_Load)
  o_mean08 <- mean(o_load_links_n08$Total_Load)
  o_mean1 <- mean(o_load_links_n1$Total_Load)
  o_mean12 <- mean(o_load_links_n12$Total_Load)

  o_median04 <-  median(o_load_links_n04$Total_Load)
  o_median06 <- median(o_load_links_n06$Total_Load)
  o_median08 <-  median(o_load_links_n08$Total_Load)
  o_median1 <-  median(o_load_links_n1$Total_Load)
  o_median12 <-  median(o_load_links_n12$Total_Load)

  o_sd04 <- sd(o_load_links_n04$Total_Load)
  o_sd06 <- sd(o_load_links_n06$Total_Load)
  o_sd08 <- sd(o_load_links_n08$Total_Load)
  o_sd1 <- sd(o_load_links_n1$Total_Load)
  o_sd12 <- sd(o_load_links_n12$Total_Load)

  o_load_links_means04 = append(o_load_links_means04,o_mean04)
  o_load_links_means06 = append(o_load_links_means06,o_mean06)
  o_load_links_means08 = append(o_load_links_means08,o_mean08)
  o_load_links_means1 = append(o_load_links_means1,o_mean1)
  o_load_links_means12 = append(o_load_links_means12,o_mean12)

  o_load_links_median04 = append(o_load_links_median04,o_median04)
  o_load_links_median06 = append(o_load_links_median06,o_median06)
  o_load_links_median08 = append(o_load_links_median08,o_median08)
  o_load_links_median1 = append(o_load_links_median1,o_median1)
  o_load_links_median12 = append(o_load_links_median12,o_median12)

  o_load_links_sd04 = append(o_load_links_sd04,o_sd04)
  o_load_links_sd06 = append(o_load_links_sd06,o_sd06)
  o_load_links_sd08 = append(o_load_links_sd08,o_sd08)
  o_load_links_sd1 = append(o_load_links_sd1,o_sd1)
  o_load_links_sd12 = append(o_load_links_sd12,o_sd12)
}

o_load_links_means04 <- na.omit(o_load_links_means04)
o_load_links_means06 <- na.omit(o_load_links_means06)
o_load_links_means08 <- na.omit(o_load_links_means08)
o_load_links_means1 <- na.omit(o_load_links_means1)
o_load_links_means12 <- na.omit(o_load_links_means12)

o_load_links_median04 <- na.omit(o_load_links_median04)
o_load_links_median06 <- na.omit(o_load_links_median06)
o_load_links_median08 <- na.omit(o_load_links_median08)
o_load_links_median1 <- na.omit(o_load_links_median1)
o_load_links_median12 <- na.omit(o_load_links_median12)

o_load_links_sd04 <- na.omit(o_load_links_sd04)
o_load_links_sd06 <- na.omit(o_load_links_sd06)
o_load_links_sd08 <- na.omit(o_load_links_sd08)
o_load_links_sd1 <- na.omit(o_load_links_sd1)
o_load_links_sd12 <- na.omit(o_load_links_sd12)

o_sd_top04 <- o_load_links_means04+o_load_links_sd04
o_sd_bottom04 <- o_load_links_means04-o_load_links_sd04
o_sd_top06 <- o_load_links_means06+o_load_links_sd06
o_sd_bottom06 <- o_load_links_means06-o_load_links_sd06
o_sd_top08 <- o_load_links_means08+o_load_links_sd08
o_sd_bottom08 <- o_load_links_means08-o_load_links_sd08
o_sd_top1 <- o_load_links_means1+o_load_links_sd1
o_sd_bottom1 <- o_load_links_means1-o_load_links_sd1
o_sd_top12 <- o_load_links_means12+o_load_links_sd12
o_sd_bottom12 <- o_load_links_means12-o_load_links_sd12

 x <- c(1:99)
 y04_means <-o_load_links_means04[1:99]
 y06_means <-o_load_links_means06[1:99]
 y08_means <-o_load_links_means08[1:99]
 y1_means <-o_load_links_means1[1:99]
 y12_means <-o_load_links_means12[1:99]

 y04_median <-o_load_links_median04[1:99]
 y06_median <-o_load_links_median06[1:99]
 y08_median <-o_load_links_median08[1:99]
 y1_median <-o_load_links_median1[1:99]
 y12_median <-o_load_links_median12[1:99]

 par(mfrow=c(3,2))


 plot(ecdf(load_links_optic04$Total_Load),col="#CCE5FF")
 lines(ecdf(load_links_optic06$Total_Load),col="#36393D")
 lines(ecdf(load_links_optic08$Total_Load),col="#003366")
 lines(ecdf(load_links_optic1$Total_Load),col="#B20000")
 lines(ecdf(load_links_optic12$Total_Load),col="#647687")

 plot(load_links_optic04$Total_Load,col="#CCE5FF")
 plot(load_links_optic06$Total_Load,col="#36393D")
 plot(load_links_optic08$Total_Load,col="#003366")
 plot(load_links_optic1$Total_Load,col="#B20000")
 plot(load_links_optic12$Total_Load,col="#647687")

 h04 <- hist(load_links_optic04$Total_Load,col="#CCE5FF")
 h06 <- hist(load_links_optic06$Total_Load,col="#36393D")
 h08 <- hist(load_links_optic08$Total_Load,col="#003366")
 h1 <- hist(load_links_optic1$Total_Load,col="#B20000")
 h12 <- hist(load_links_optic12$Total_Load,col="#647687")

 boxplot(load_links_optic04$Total_Load,col="#CCE5FF")
 boxplot(load_links_optic06$Total_Load,col="#36393D")
 boxplot(load_links_optic08$Total_Load,col="#003366")
 boxplot(load_links_optic1$Total_Load,col="#B20000")
 boxplot(load_links_optic12$Total_Load,col="#647687")

 #par(mfrow=c(3,2))

 plot(x,y04_means,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y04_means ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y06_means,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y06_means ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y08_means,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y08_means ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y1_means,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y1_means ~ x + I(x^2) + I(x^3))
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y12_means,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y12_means ~ x + I(x^2) + I(x^3))
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 #par(mfrow=c(3,2))

 plot(x,y04_median,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y04_median ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y06_median,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y06_median ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y08_median,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y08_median ~ x + I(x^2) + I(x^3) )
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y1_median,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y1_median ~ x + I(x^2) + I(x^3))
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )

 plot(x,y12_median,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Load",ylim = c(0,200))
 model <- lm(y12_median ~ x + I(x^2) + I(x^3))
 myPredict <- predict( model , interval="predict" )
 ix <- sort(x,index.return=T)$ix
 lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
```

### Utilização de Cache Vs Cloud.

```{r echo=FALSE, results=TRUE, warning=FALSE}
# x <- c(1:100)
# y04 <- cache_vs_cloud04$Cache
# y06 <- cache_vs_cloud06$Cache
# y08 <- cache_vs_cloud08$Cache
# y1 <- cache_vs_cloud1$Cache
# y12 <- cache_vs_cloud12$Cache
# plot(x,y04,col="#CCE5FF", pch=16 , cex=1.3 , xlab="Events" , ylab="Utilização de Cache",type="l", ylim=c(0,1))
# lines(y06,col="#36393D")
# lines(y08,col="#003366")
# lines(y1,col="#B20000")
# lines(y12,col="#647687")
# legend(x = "bottomright", 
#        legend = c(expression(paste(alpha, " = ", 0.4)), expression(paste(alpha, " = ", 0.6)),expression(paste(alpha, " = ", 0.8)), expression(paste(alpha, " = ", 1.0)),expression(paste(alpha, " = ", 1.2))),
#        col = c("#CCE5FF", "#36393D", "#003366", "#B20000", "#647687"), 
#        horiz = F ,
#        lty = 1,
#        lwd = 5, 
#        bty = "n")

#par(mflow= c(1,3))
#barplot(cache_vs_cloud04$Cache,xlab = "Events")
#barplot(cache_vs_cloud04$Cache,xlab = "Events")
#barplot(cache_vs_cloud04$Cache,xlab = "Events")
#par(mflow= c(1,1))
#Grouped barplot
#barplot(cache_vs_cloud04$Cache,cache_vs_cloud04$Cloud, col=colors()[c(23,89,12)] , border="white", font.axis=2,beside=T, xlab="Events",font.lab=2)

ratio_server_use04 <- NULL
for (i in 1:n){
  server_use_n04 <- server_use04 %>% filter(server_use04$Event == i)
  sum_total_storage_n04 <- sum(server_use_n04$Total_Storage)
  sum_total_use_n04 <- sum(server_use_n04$Total_Use)
  ratio_server_use_n04 <- (sum_total_use_n04 / sum_total_storage_n04)
  
  ratio_server_use04 <- append(ratio_server_use04,ratio_server_use_n04)
  
  server_use_n04 <- NULL
  sum_total_storage_n04 <- NULL
  ratio_server_use_n04 <- NULL

}

y_max04 <- max(y04_means)
y_mean_normal04 <- (y04_means) / y_max04

(y_mean_normal04)
type_cache <- rep("Average Delay",99)
d0 <- data.frame(event=c(rep(1:99,1)),
                           ratio_cache_hit = y_mean_normal04,
                           type = type_cache,
                           stringsAsFactors = FALSE)


type_cache <- rep("Ratio Cache Hit",100)
d1 <- data.frame(event=c(cache_vs_cloud04$Event),
                           ratio_cache_hit = c(cache_vs_cloud04$Cache),
                           type = type_cache,
                           stringsAsFactors = FALSE)
type_cloud <- rep("Ratio Cache Miss",100)
d2 <- data.frame(event=c(cache_vs_cloud04$Event),
                           ratio_cache_hit = c(cache_vs_cloud04$Cloud),
                           type = type_cloud,
                           stringsAsFactors = FALSE)
type_server_use <- rep("Server Load",100)
d3 <- data.frame(event=c(rep(1:100,1)),
                           ratio_cache_hit = ratio_server_use04,
                           type = type_server_use,
                           stringsAsFactors = FALSE)
d4 <- bind_rows(d1,d2,d3)

d5 <- bind_rows(d1,d2)

# create a dataset
events <- d4$event
condition <- d4$type
hit <- d4$ratio_cache_hit
data <- data.frame(events,condition,hit)
 
# Stacked + percent
# ggplot(data, aes(fill=condition, y=hit, x=events)) +
#     geom_bar(position="fill", stat="identity")+
#     ggtitle("Ratio Cache")+
#     xlab("Events")+
#     ylab("Ratio Cache")

# Stacked 
ggplot(data, aes(fill=condition, y=hit, x=events)) + 
    geom_bar(position="stack", stat="identity")+
    ggtitle("Ratio Cache")+
    xlab("Events")+
    ylab("Ratio Cache")

# Second option
events <- d5$event
condition <- d5$type
hit1 <- d5$ratio_cache_hit
data1 <- data.frame(events,condition,hit1)

# Stacked + percent
ggplot(data1, aes(fill=condition, y=hit1, x=events)) + 
    geom_bar(position="stack", stat="identity")+
    ggtitle("Ratio Cache")+
    xlab("Events")+
    ylab("Ratio Cache")



events2 <- c(rep(1:100,1))
hit2 <- ratio_server_use04
data2 <- data.frame(events2,hit2)

ggplot(data2, aes(x=events2, y=hit2)) + 
    geom_bar(stat = "identity")+
    ggtitle("Server User")+
    xlab("Events")+
    ylab("Ratio Server Use")

 # Small multiple
# ggplot(data, aes(fill=condition, y=hit, x=events)) +
#     geom_bar(position="stack", stat="identity") +
#     scale_fill_viridis(discrete = T) +
#     ggtitle("Studying 4 species..") +
#     theme_ipsum() +
#     xlab("")
#theme(legend.position="none")


# plot(x,y04, xlab="Events" , ylab="Utilização de Cache",type="l", ylim=c(0,1))
# lines(y06)
# lines(y08)
# lines(y1)
# lines(y12)
# legend(x = "bottomright",
#        legend = c(expression(paste(alpha, " = ", 0.4)), expression(paste(alpha, " = ", 0.6)),expression(paste(alpha, " = ", 0.8)), expression(paste(alpha, " = ", 1.0)),expression(paste(alpha, " = ", 1.2))),
#        col = c("#CCE5FF", "#36393D", "#003366", "#B20000", "#647687"),
#        horiz = F ,
#        lty = 1,
#        lwd = 5,
#        bty = "n")


events <- d4$event
condition <- d4$type
hit <- d4$ratio_cache_hit
data <- data.frame(events,condition,hit)

ggplot( data, aes(x=events, y=hit, group=condition, color=condition)) +
    geom_line()+ theme_bw() +
    ggtitle("ZIPF 0.4")+
    scale_fill_viridis(discrete = TRUE) +
    xlab("Events")+
    ylab("Ratio")


barplot(cache_vs_cloud04$Cache, col="#F8766D", ylim=c(0,1),border = NA, xlab="Events",ylab="Ratio")
par(new=T)
barplot(ratio_server_use04, col="#619CFF", axes=F,ylim=c(0,1),border = NA)
par(new=T)
barplot(cache_vs_cloud04$Cloud, col="#01BA38", axes=F,ylim=c(0,1),border = NA)
title(main = "ZIPF 04")


plot(x,y_mean_normal04,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay")
model <- lm(y_mean_normal04 ~ x + I(x^2) + I(x^3) )
myPredict <- predict( model , interval="predict" )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
#plot(ecdf(delay04$Delay),col="#36393D", axes=F, ylim=c(0,1))
#par(new=T)
plot(cache_vs_cloud04$Cache, col="#F8766D", ylim=c(0,1),border = NA, xlab="Events",ylab="Ratio",type="l")
par(new=T)
lines(ratio_server_use04, col="#619CFF", axes=F,ylim=c(0,1), border = NA)
par(new=T)
lines(cache_vs_cloud04$Cloud, col="#01BA38", axes=F,ylim=c(0,1), border = NA)
par(new=T)
title(main = "ZIPF 04")


plot(ecdf(delay04$Delay),col="#619CFF")
plot(delay04$Delay,col="#619CFF")
#delay04_model <- lm(delay04$Delay)



max_n04 <- max(delay04$Delay)
delay_normal04 <- (delay04$Delay) / max_n04


plot(ecdf(delay_normal04),col="#619CFF")
plot(delay_normal04,col="#619CFF")


delay_scale04 <- scale(delay_normal04)
set.seed(1)
delay_cluster04 <- kmeans(x = delay_scale04, centers = 2)
delay_prev04 <- delay_cluster04$cluster

plot(delay_scale04, col=delay_prev04)

```

```{r}


delay_links_means04 <- c()
delay_links_means06 <- c()
delay_links_means08 <- c()
delay_links_means1 <- c()
delay_links_means12 <- c()

delay_links_median04 <- c()
delay_links_median06 <- c()
delay_links_median08 <- c()
delay_links_median1 <- c()
delay_links_median12 <- c()

delay_links_sd04 <- c()
delay_links_sd06 <- c()
delay_links_sd08 <- c()
delay_links_sd1 <- c()
delay_links_sd12 <- c()

delay_links_median04 <- c()
delay_links_median06 <- c()
delay_links_median08 <- c()
delay_links_median1 <- c()
delay_links_median12 <- c()

#delay04$Delay <- delay04$Delay * 1000
(unique(delay04$Request))
for (i in unique(delay04$Request)){
   delay_links_n04 <- delay04 %>% filter(delay04$Request == i)
   delay_links_n06 <- delay06 %>% filter(delay06$Request == i)
   delay_links_n08 <- delay08 %>% filter(delay08$Request == i)
   delay_links_n1 <- delay1 %>% filter(delay1$Request == i)
   delay_links_n12 <- delay12 %>% filter(delay12$Request == i)

   delay_mean04 <- mean(delay_links_n04$Delay)
   delay_mean06 <- mean(delay_links_n06$Delay)
   delay_mean08 <- mean(delay_links_n08$Delay)
   delay_mean1 <- mean(delay_links_n1$Delay)
   delay_mean12 <- mean(delay_links_n12$Delay)

   delay_median04 <- median(delay_links_n04$Delay)
   delay_median06 <-  median(delay_links_n06$Delay)
   delay_median08 <-  median(delay_links_n08$Delay)
   delay_median1 <-  median(delay_links_n1$Delay)
   delay_median12 <-  median(delay_links_n12$Delay)

   delay_sd04 <- sd(delay_links_n04$Delay)
   delay_sd06 <- sd(delay_links_n06$Delay)
   delay_sd08 <- sd(delay_links_n08$Delay)
   delay_sd1 <- sd(delay_links_n1$Delay)
   delay_sd12 <- sd(delay_links_n12$Delay)

   delay_links_means04 = append(delay_links_means04,delay_mean04)
   delay_links_means06 = append(delay_links_means06,delay_mean06)
   delay_links_means08 = append(delay_links_means08,delay_mean08)
   delay_links_means1 = append(delay_links_means1,delay_mean1)
   delay_links_means12 = append(delay_links_means12,delay_mean12)

   delay_links_median04 = append(delay_links_median04,delay_median04)
   delay_links_median06 = append(delay_links_median06,delay_median06)
   delay_links_median08 = append(delay_links_median08,delay_median08)
   delay_links_median1 = append(delay_links_median1,delay_median1)
   delay_links_median12 = append(delay_links_median12,delay_median12)

   delay_links_sd04 = append(delay_links_sd04,delay_sd04)
   delay_links_sd06 = append(delay_links_sd06,delay_sd06)
   delay_links_sd08 = append(delay_links_sd08,delay_sd08)
   delay_links_sd1 = append(delay_links_sd1,delay_sd1)
   delay_links_sd12 = append(delay_links_sd12,delay_sd12)
 }

 delay_links_means04 <- na.omit(delay_links_means04)
 delay_links_means06 <- na.omit(delay_links_means06)
 delay_links_means08 <- na.omit(delay_links_means08)
 delay_links_means1 <- na.omit(delay_links_means1)
 delay_links_means12 <- na.omit(delay_links_means12)

 delay_links_median04 <- na.omit(delay_links_median04)
 delay_links_median06 <- na.omit(delay_links_median06)
 delay_links_median08 <- na.omit(delay_links_median08)
 delay_links_median1 <- na.omit(delay_links_median1)
 delay_links_median12 <- na.omit(delay_links_median12)

 delay_links_sd04 <- na.omit(delay_links_sd04)
 delay_links_sd06 <- na.omit(delay_links_sd06)
 delay_links_sd08 <- na.omit(delay_links_sd08)
 delay_links_sd1 <- na.omit(delay_links_sd1)
 delay_links_sd12 <- na.omit(delay_links_sd12)

 delay_sd_top04 <- delay_links_means04+delay_links_sd04
 delay_sd_bottom04 <- delay_links_means04-delay_links_sd04
 delay_sd_top06 <- delay_links_means06+delay_links_sd06
 delay_sd_bottom06 <- delay_links_means06-delay_links_sd06
 delay_sd_top08 <- delay_links_means08+delay_links_sd08
 delay_sd_bottom08 <- delay_links_means08-delay_links_sd08
 delay_sd_top1 <- delay_links_means1+delay_links_sd1
 delay_sd_bottom1 <- delay_links_means1-delay_links_sd1
 delay_sd_top12 <- delay_links_means12+delay_links_sd12
 delay_sd_bottom12 <- delay_links_means12-delay_links_sd12

 # summary(delay_links_means04)
 # summary(delay_links_means06)
 # summary(delay_links_means08)
 # summary(delay_links_means1)
 # summary(delay_links_means12)
 #
 # summary(delay_links_median04)
 # summary(delay_links_median06)
 # summary(delay_links_median08)
 # summary(delay_links_median1)
 # summary(delay_links_median12)

 x <- c(1:499)
 
 y04_req <-delay_links_means04[1:499]
 y06 <-delay_links_means06[1:499]
 y08 <-delay_links_means08[1:499]
 y1 <-delay_links_means1[1:499]
 y12 <-delay_links_means12[1:499]
 
 # summary(delay1$Delay)
 # summary(y)
 #par(mfrow=c(2,2))
 plot(ecdf(delay04$Delay),col="#619CFF")
 lines(ecdf(delay06$Delay),col="#36393D")
 lines(ecdf(delay08$Delay),col="#003366")
 lines(ecdf(delay1$Delay),col="#B20000")
 lines(ecdf(delay12$Delay),col="#647687") 

 
 plot(delay04$Delay,col="#619CFF")
 plot(delay06$Delay,col="#36393D")
 plot(delay08$Delay,col="#003366")
 plot(delay1$Delay,col="#B20000")
 plot(delay12$Delay,col="#647687")
 
 h04 <- hist(delay04$Delay,col="#619CFF")
 h06 <- hist(delay06$Delay,col="#36393D")
 h08 <- hist(delay08$Delay,col="#003366")
 h1 <- hist(delay1$Delay,col="#B20000")
 h12 <- hist(delay12$Delay,col="#647687")

 boxplot(delay04$Delay,col="#619CFF")
 boxplot(delay06$Delay,col="#36393D")
 boxplot(delay08$Delay,col="#003366")
 boxplot(delay1$Delay,col="#B20000")
 boxplot(delay12$Delay,col="#647687")

 plot(ecdf(y04_req),col="#619CFF")
 plot(y04_req)
 #c("#CCE5FF", "#36393D", "#003366", "#B20000", "#647687")
 #par(mfrow=c(3,2))

 # plot(x,y06,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 # model <- lm(y06 ~ x + I(x^2) + I(x^3) )
 # myPredict <- predict( model , interval="predict" )
 # ix <- sort(x,index.return=T)$ix
 # lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 # 
 # plot(x,y08,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 # model <- lm(y08 ~ x + I(x^2) + I(x^3) )
 # myPredict <- predict( model , interval="predict" )
 # ix <- sort(x,index.return=T)$ix
 # lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 # 
 # plot(x,y1,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 # model <- lm(y1 ~ x + I(x^2) + I(x^3))
 # myPredict <- predict( model , interval="predict" )
 # ix <- sort(x,index.return=T)$ix
 # lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 # 
 # plot(x,y12,col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Events" , ylab="Average Delay",ylim = c(0,0.02))
 # model <- lm(y12 ~ x + I(x^2) + I(x^3))
 # myPredict <- predict( model , interval="predict" )
 # ix <- sort(x,index.return=T)$ix
 # lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
 
```
```{r}
x <- c(1:480)

plot(x,na.omit(y04_req),col=rgb(0.4,0.4,0.8,0.6), pch=16 , cex=1.3 , xlab="Requests" , ylab="Average Delay")
  model <- lm(na.omit(y04_req) ~ x + I(x^2) + I(x^3) )
  myPredict <- predict( model , interval="predict" )
  ix <- sort(x,index.return=T)$ix
  lines(x[ix], myPredict[ix , 1], col=2, lwd=2 )
  polygon(c(rev(x[ix]), x[ix]), c(rev(myPredict[ ix,3]), myPredict[ ix,2]), col = rgb(0.7,0.7,0.7,0.4) , border = NA)
```

```{r}

```


# (figure1 <- ggarrange(g1, g2,g3,g4,
#                     labels = c("\U03B1: 0.4", "\U03B1: 0.6", "\U03B1: 0.8","\U03B1: 1.0","\U03B1: 1.2"),font.label = list(size=12,face="plain"),
#                       hjust=-4,
#                     vjust=0.6,
#                     common.legend = TRUE, legend = "top",
#                     ncol = 2, nrow = 2))


# ggarrange(
#   g1,                # First row with line plot
#   # Second row with box and dot plots
#   ggarrange(g2, g3, g4,g5, ncol = 2,nrow=2, labels = c("\U03B1: 0.6", "\U03B1: 0.8","\U03B1: 1.0","\U03B1: 1.2")), 
#   nrow = 2, 
#   labels = "\U03B1: 0.4"      # Label of the line plot
#   ) 
